[2025-09-28 20:35:01,329][__main__][INFO] - Configuration:
[2025-09-28 20:35:01,333][__main__][INFO] - model:
  name: deep_cf
  type: DeepCollaborativeFiltering
  embedding_dim: 64
  hidden_dims:
  - 256
  - 128
  - 64
  dropout: 0.4
  batch_norm: true
  activation: relu
  description: Deep neural network for collaborative filtering
train:
  name: default
  batch_size: 256
  learning_rate: 0.01
  weight_decay: 0.0001
  epochs: 20
  patience: 5
  min_delta: 0.0001
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto

[2025-09-28 20:35:01,337][__main__][INFO] - Using device: cuda
[2025-09-28 20:35:01,337][__main__][INFO] - Loading data...
[2025-09-28 20:35:01,435][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-28 20:35:01,435][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-28 20:35:03,881][__main__][INFO] - Creating model: DeepCollaborativeFiltering
[2025-09-28 20:35:03,899][__main__][INFO] - Model created with 736,769 parameters
[2025-09-28 20:35:03,900][__main__][INFO] - Starting training...
[2025-09-28 20:35:20,618][__main__][INFO] - Epoch 1/20: Train Loss: 0.3894, Val Loss: 0.3722
[2025-09-28 20:35:20,619][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34507947369191677), 'mae': 0.23939889669418335, 'accuracy': np.float64(0.8366867138548478), 'precision': np.float64(0.6173375349307331), 'recall': np.float64(0.21028008992040828), 'f1': np.float64(0.31370475557435495)}
[2025-09-28 20:35:20,621][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33840397333211897), 'mae': 0.23468442261219025, 'accuracy': np.float64(0.8442098298404844), 'precision': np.float64(0.6522617124394184), 'recall': np.float64(0.26177161844557906), 'f1': np.float64(0.3736047654849343)}
[2025-09-28 20:35:20,645][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:35:36,411][__main__][INFO] - Epoch 2/20: Train Loss: 0.3675, Val Loss: 0.3592
[2025-09-28 20:35:36,411][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3356412313042144), 'mae': 0.22611182928085327, 'accuracy': np.float64(0.8426900858086758), 'precision': np.float64(0.6311463927153864), 'recall': np.float64(0.2737306843267108), 'f1': np.float64(0.3818510566165668)}
[2025-09-28 20:35:36,411][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33279775891320285), 'mae': 0.2272971272468567, 'accuracy': np.float64(0.8466694475209643), 'precision': np.float64(0.6105041463735685), 'recall': np.float64(0.3758813518113299), 'f1': np.float64(0.4652889245585875)}
[2025-09-28 20:35:36,428][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:35:51,270][__main__][INFO] - Epoch 3/20: Train Loss: 0.3591, Val Loss: 0.3591
[2025-09-28 20:35:51,271][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3322663316465784), 'mae': 0.22166317701339722, 'accuracy': np.float64(0.8443580885551286), 'precision': np.float64(0.6378099079907538), 'recall': np.float64(0.28499098770682707), 'f1': np.float64(0.39395296752519593)}
[2025-09-28 20:35:51,271][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3325369518046798), 'mae': 0.21797434985637665, 'accuracy': np.float64(0.847014657019979), 'precision': np.float64(0.620591984138224), 'recall': np.float64(0.3551341275630116), 'f1': np.float64(0.4517525773195876)}
[2025-09-28 20:35:51,286][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:36:06,393][__main__][INFO] - Epoch 4/20: Train Loss: 0.3557, Val Loss: 0.3533
[2025-09-28 20:36:06,393][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33100400103429883), 'mae': 0.21985003352165222, 'accuracy': np.float64(0.8449080980814374), 'precision': np.float64(0.6367225195192561), 'recall': np.float64(0.29398302853555297), 'f1': np.float64(0.40224454450987185)}
[2025-09-28 20:36:06,394][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33118504796125564), 'mae': 0.2242198884487152, 'accuracy': np.float64(0.8463817729384521), 'precision': np.float64(0.6798959011060507), 'recall': np.float64(0.2540724531971797), 'f1': np.float64(0.36991150442477877)}
[2025-09-28 20:36:06,411][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:36:22,931][__main__][INFO] - Epoch 5/20: Train Loss: 0.3547, Val Loss: 0.3499
[2025-09-28 20:36:22,931][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33077813584452437), 'mae': 0.2194451242685318, 'accuracy': np.float64(0.8449907792520589), 'precision': np.float64(0.635826857118048), 'recall': np.float64(0.29659558093849364), 'f1': np.float64(0.40450214058831657)}
[2025-09-28 20:36:22,931][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3296368600724631), 'mae': 0.2198001593351364, 'accuracy': np.float64(0.8474893200811242), 'precision': np.float64(0.6767820773930754), 'recall': np.float64(0.26930869600453844), 'f1': np.float64(0.38529769841729955)}
[2025-09-28 20:36:22,957][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:36:38,401][__main__][INFO] - Epoch 6/20: Train Loss: 0.3536, Val Loss: 0.3514
[2025-09-28 20:36:38,401][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33051933054798277), 'mae': 0.2189907282590866, 'accuracy': np.float64(0.844426390391729), 'precision': np.float64(0.6363798962618494), 'recall': np.float64(0.2882313627802418), 'f1': np.float64(0.39676056927001296)}
[2025-09-28 20:36:38,402][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33013800354421924), 'mae': 0.21486526727676392, 'accuracy': np.float64(0.8461084820850654), 'precision': np.float64(0.5919076440260032), 'recall': np.float64(0.4279925439662858), 'f1': np.float64(0.4967781383754292)}
[2025-09-28 20:36:54,029][__main__][INFO] - Epoch 7/20: Train Loss: 0.3533, Val Loss: 0.3521
[2025-09-28 20:36:54,029][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33037555994887713), 'mae': 0.2188117355108261, 'accuracy': np.float64(0.8451920899283549), 'precision': np.float64(0.6363557821072184), 'recall': np.float64(0.29833728254045405), 'f1': np.float64(0.4062267324821443)}
[2025-09-28 20:36:54,030][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33034367009162746), 'mae': 0.21871575713157654, 'accuracy': np.float64(0.8458783424190556), 'precision': np.float64(0.5897435897435898), 'recall': np.float64(0.4324499554258854), 'f1': np.float64(0.4989947164165147)}
[2025-09-28 20:37:10,017][__main__][INFO] - Epoch 8/20: Train Loss: 0.3521, Val Loss: 0.3531
[2025-09-28 20:37:10,017][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3298127953240867), 'mae': 0.21816222369670868, 'accuracy': np.float64(0.8455911164474418), 'precision': np.float64(0.6369138959931799), 'recall': np.float64(0.30261052716851977), 'f1': np.float64(0.41028598102612684)}
[2025-09-28 20:37:10,017][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32971358625432123), 'mae': 0.2140537053346634, 'accuracy': np.float64(0.8483954950160378), 'precision': np.float64(0.6201415787364766), 'recall': np.float64(0.3762865710349299), 'f1': np.float64(0.4683748612932513)}
[2025-09-28 20:37:24,288][__main__][INFO] - Epoch 9/20: Train Loss: 0.3528, Val Loss: 0.3493
[2025-09-28 20:37:24,289][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3304944206530081), 'mae': 0.21880750358104706, 'accuracy': np.float64(0.8441352088778008), 'precision': np.float64(0.6354715282466802), 'recall': np.float64(0.285902343196225), 'f1': np.float64(0.39437367303609344)}
[2025-09-28 20:37:24,289][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32879521405308504), 'mae': 0.21873797476291656, 'accuracy': np.float64(0.8482948089121586), 'precision': np.float64(0.6449369136201877), 'recall': np.float64(0.32312180889861414), 'f1': np.float64(0.4305383078667459)}
[2025-09-28 20:37:24,307][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:37:36,565][__main__][INFO] - Epoch 10/20: Train Loss: 0.3508, Val Loss: 0.3516
[2025-09-28 20:37:36,566][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32932473151962627), 'mae': 0.2171752005815506, 'accuracy': np.float64(0.8455839267804311), 'precision': np.float64(0.6429398148148148), 'recall': np.float64(0.2925046074083075), 'f1': np.float64(0.4020823763589037)}
[2025-09-28 20:37:36,566][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32982258808769516), 'mae': 0.21673108637332916, 'accuracy': np.float64(0.8478920644966415), 'precision': np.float64(0.6271993077588693), 'recall': np.float64(0.3524596806872518), 'f1': np.float64(0.4513049343641364)}
[2025-09-28 20:37:49,448][__main__][INFO] - Epoch 11/20: Train Loss: 0.3516, Val Loss: 0.3491
[2025-09-28 20:37:49,448][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3295897646303435), 'mae': 0.21770960092544556, 'accuracy': np.float64(0.8456414441165158), 'precision': np.float64(0.6414447666754548), 'recall': np.float64(0.2956437207606781), 'f1': np.float64(0.4047411104179663)}
[2025-09-28 20:37:49,448][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32876255901628104), 'mae': 0.2167484164237976, 'accuracy': np.float64(0.8488413906189318), 'precision': np.float64(0.655295315682281), 'recall': np.float64(0.31291028446389496), 'f1': np.float64(0.4235642586802698)}
[2025-09-28 20:37:49,459][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:37:59,940][__main__][INFO] - Epoch 12/20: Train Loss: 0.3512, Val Loss: 0.3516
[2025-09-28 20:37:59,940][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3296090466591953), 'mae': 0.21760444343090057, 'accuracy': np.float64(0.8455120301103254), 'precision': np.float64(0.6407651715039577), 'recall': np.float64(0.2950969074670393), 'f1': np.float64(0.4040933483089979)}
[2025-09-28 20:37:59,941][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3307602847721179), 'mae': 0.21948933601379395, 'accuracy': np.float64(0.8427283057405462), 'precision': np.float64(0.7186430127606598), 'recall': np.float64(0.18713023745846502), 'f1': np.float64(0.29693930041152267)}
[2025-09-28 20:38:10,116][__main__][INFO] - Epoch 13/20: Train Loss: 0.3514, Val Loss: 0.3480
[2025-09-28 20:38:10,117][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3294677734375), 'mae': 0.21746905148029327, 'accuracy': np.float64(0.8461770743088034), 'precision': np.float64(0.6415767527833899), 'recall': np.float64(0.30226623731696944), 'f1': np.float64(0.4109306167400881)}
[2025-09-28 20:38:10,117][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3282452204131875), 'mae': 0.22153325378894806, 'accuracy': np.float64(0.8483235763704098), 'precision': np.float64(0.6065320665083136), 'recall': np.float64(0.4138909149850069), 'f1': np.float64(0.4920275543137916)}
[2025-09-28 20:38:10,132][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:38:19,837][__main__][INFO] - Epoch 14/20: Train Loss: 0.3506, Val Loss: 0.3497
[2025-09-28 20:38:19,839][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32907404345908275), 'mae': 0.2169475108385086, 'accuracy': np.float64(0.8463496263170571), 'precision': np.float64(0.64468576911335), 'recall': np.float64(0.29937015209510504), 'f1': np.float64(0.40887339916466137)}
[2025-09-28 20:38:19,839][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32939285608132), 'mae': 0.22666572034358978, 'accuracy': np.float64(0.8487263207859269), 'precision': np.float64(0.6446031746031746), 'recall': np.float64(0.32911905340789366), 'f1': np.float64(0.43575299104029186)}
[2025-09-28 20:38:29,487][__main__][INFO] - Epoch 15/20: Train Loss: 0.3504, Val Loss: 0.3480
[2025-09-28 20:38:29,488][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3291444835350654), 'mae': 0.21714460849761963, 'accuracy': np.float64(0.8463927643191206), 'precision': np.float64(0.6464290434859232), 'recall': np.float64(0.29714239423213235), 'f1': np.float64(0.4071371090823321)}
[2025-09-28 20:38:29,488][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32845744821018763), 'mae': 0.21335677802562714, 'accuracy': np.float64(0.8481797390791537), 'precision': np.float64(0.6656145562569625), 'recall': np.float64(0.29054218332117676), 'f1': np.float64(0.4045133991537377)}
[2025-09-28 20:38:39,868][__main__][INFO] - Epoch 16/20: Train Loss: 0.3510, Val Loss: 0.3491
[2025-09-28 20:38:39,869][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32936736333271355), 'mae': 0.21731628477573395, 'accuracy': np.float64(0.8459326256304439), 'precision': np.float64(0.6440153757787301), 'recall': np.float64(0.2951981691880835), 'f1': np.float64(0.4048326621302597)}
[2025-09-28 20:38:39,869][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32898638829521337), 'mae': 0.2179819643497467, 'accuracy': np.float64(0.8473742502481193), 'precision': np.float64(0.6635744036349868), 'recall': np.float64(0.2840586757435773), 'f1': np.float64(0.39782078202145166)}
[2025-09-28 20:38:50,195][__main__][INFO] - Epoch 17/20: Train Loss: 0.3504, Val Loss: 0.3510
[2025-09-28 20:38:50,196][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32921178539714346), 'mae': 0.21711008250713348, 'accuracy': np.float64(0.8466479974979959), 'precision': np.float64(0.6484444051617465), 'recall': np.float64(0.2971626465763412), 'f1': np.float64(0.40755503090063194)}
[2025-09-28 20:38:50,196][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33016325625898896), 'mae': 0.21462805569171906, 'accuracy': np.float64(0.8467845173539692), 'precision': np.float64(0.6067046173308033), 'recall': np.float64(0.38868627927708893), 'f1': np.float64(0.47381940327998423)}
[2025-09-28 20:38:59,781][__main__][INFO] - Epoch 18/20: Train Loss: 0.3502, Val Loss: 0.3489
[2025-09-28 20:38:59,782][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3291111387223568), 'mae': 0.2170352339744568, 'accuracy': np.float64(0.8465149886583003), 'precision': np.float64(0.6425918811627609), 'recall': np.float64(0.30487878971991006), 'f1': np.float64(0.41354870611504857)}
[2025-09-28 20:38:59,782][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32883633982846366), 'mae': 0.21724607050418854, 'accuracy': np.float64(0.849690030637343), 'precision': np.float64(0.6449731389102072), 'recall': np.float64(0.34054623551341273), 'f1': np.float64(0.4457409568261377)}
[2025-09-28 20:38:59,782][__main__][INFO] - Early stopping after 18 epochs
[2025-09-28 20:38:59,782][__main__][INFO] - Training completed!
[2025-09-28 20:38:59,782][__main__][INFO] - Best validation loss: 0.3480
