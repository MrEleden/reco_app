[2025-09-28 20:07:44,608][__main__][INFO] - Configuration:
[2025-09-28 20:07:44,610][__main__][INFO] - model:
  name: collaborative
  type: CollaborativeFilteringModel
  embedding_dim: 50
  dropout: 0.2
  bias: true
  init_mean: 0.0
  init_std: 0.1
  description: Matrix factorization with user and movie embeddings
train:
  name: default
  batch_size: 256
  learning_rate: 0.01
  weight_decay: 0.0001
  epochs: 20
  patience: 5
  min_delta: 0.0001
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto

[2025-09-28 20:07:44,628][__main__][INFO] - Using device: cuda
[2025-09-28 20:07:44,628][__main__][INFO] - Loading data...
[2025-09-28 20:07:44,666][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-28 20:07:44,667][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-28 20:07:45,321][__main__][INFO] - Creating model: CollaborativeFilteringModel
[2025-09-28 20:07:45,437][__main__][INFO] - Model created with 527,953 parameters
[2025-09-28 20:07:46,106][__main__][INFO] - Starting training...
[2025-09-28 20:07:49,982][__main__][INFO] - Epoch 1/20: Train Loss: 0.4243, Val Loss: 0.3994
[2025-09-28 20:07:49,982][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3624325755324684), 'mae': 0.28287437558174133, 'accuracy': np.float64(0.8290297184885882), 'precision': np.float64(0.7548387096774194), 'recall': np.float64(0.05449905826599429), 'f1': np.float64(0.10165841864682104)}
[2025-09-28 20:07:49,982][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34993089777118935), 'mae': 0.26044851541519165, 'accuracy': np.float64(0.8320555787293413), 'precision': np.float64(0.7587822014051522), 'recall': np.float64(0.0787746170678337), 'f1': np.float64(0.14273127753303963)}
[2025-09-28 20:07:49,990][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:07:54,042][__main__][INFO] - Epoch 2/20: Train Loss: 0.3953, Val Loss: 0.3956
[2025-09-28 20:07:54,043][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34766027898275487), 'mae': 0.25873512029647827, 'accuracy': np.float64(0.8346628225913717), 'precision': np.float64(0.8), 'recall': np.float64(0.09137857707029588), 'f1': np.float64(0.16402202955450135)}
[2025-09-28 20:07:54,043][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3475641064208014), 'mae': 0.2608632445335388, 'accuracy': np.float64(0.8347165686175798), 'precision': np.float64(0.7572815533980582), 'recall': np.float64(0.1011427182105519), 'f1': np.float64(0.17845141917494814)}
[2025-09-28 20:07:54,049][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:07:58,722][__main__][INFO] - Epoch 3/20: Train Loss: 0.3932, Val Loss: 0.3947
[2025-09-28 20:07:58,722][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3465878969557641), 'mae': 0.2574918270111084, 'accuracy': np.float64(0.8353674099584077), 'precision': np.float64(0.7978369384359401), 'recall': np.float64(0.09710999048139822), 'f1': np.float64(0.17314532290970805)}
[2025-09-28 20:07:58,722][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34759510231183705), 'mae': 0.25837504863739014, 'accuracy': np.float64(0.8343425916603139), 'precision': np.float64(0.7747326203208557), 'recall': np.float64(0.09392981603047248), 'f1': np.float64(0.16754607878568847)}
[2025-09-28 20:07:58,729][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:08:03,928][__main__][INFO] - Epoch 4/20: Train Loss: 0.3924, Val Loss: 0.3941
[2025-09-28 20:08:03,928][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3461560767995455), 'mae': 0.2570486068725586, 'accuracy': np.float64(0.8358778763161584), 'precision': np.float64(0.8059848733969089), 'recall': np.float64(0.09927699131174433), 'f1': np.float64(0.17677924232315767)}
[2025-09-28 20:08:03,928][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34765949676369173), 'mae': 0.2558661699295044, 'accuracy': np.float64(0.8336377889331588), 'precision': np.float64(0.7599193006052455), 'recall': np.float64(0.09157954453359267), 'f1': np.float64(0.1634601475480978)}
[2025-09-28 20:08:03,934][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:08:08,781][__main__][INFO] - Epoch 5/20: Train Loss: 0.3913, Val Loss: 0.3944
[2025-09-28 20:08:08,782][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3456589837638256), 'mae': 0.2563289701938629, 'accuracy': np.float64(0.8358383331476003), 'precision': np.float64(0.8001941433425012), 'recall': np.float64(0.1001680944569334), 'f1': np.float64(0.17804816588070127)}
[2025-09-28 20:08:08,782][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34738205158438135), 'mae': 0.2590329945087433, 'accuracy': np.float64(0.8339110797865454), 'precision': np.float64(0.7564766839378239), 'recall': np.float64(0.09465921063295243), 'f1': np.float64(0.16826334365771087)}
[2025-09-28 20:08:13,677][__main__][INFO] - Epoch 6/20: Train Loss: 0.3905, Val Loss: 0.3927
[2025-09-28 20:08:13,677][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3452366952846202), 'mae': 0.2559937536716461, 'accuracy': np.float64(0.8362157906656553), 'precision': np.float64(0.801994301994302), 'recall': np.float64(0.1026186281062033), 'f1': np.float64(0.18195529221653653)}
[2025-09-28 20:08:13,677][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34656690455424843), 'mae': 0.2574528455734253, 'accuracy': np.float64(0.835378220157358), 'precision': np.float64(0.7660714285714286), 'recall': np.float64(0.10430342815463166), 'f1': np.float64(0.18360796062486626)}
[2025-09-28 20:08:13,683][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:08:18,510][__main__][INFO] - Epoch 7/20: Train Loss: 0.3900, Val Loss: 0.3927
[2025-09-28 20:08:18,510][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34495968811202854), 'mae': 0.2556356191635132, 'accuracy': np.float64(0.8365608946821628), 'precision': np.float64(0.8012011087157376), 'recall': np.float64(0.10537294691860583), 'f1': np.float64(0.18625046983229226)}
[2025-09-28 20:08:18,510][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3461331317100693), 'mae': 0.26049116253852844, 'accuracy': np.float64(0.8363994649252765), 'precision': np.float64(0.775871926815323), 'recall': np.float64(0.1099764972850312), 'f1': np.float64(0.19264622373651333)}
[2025-09-28 20:08:23,313][__main__][INFO] - Epoch 8/20: Train Loss: 0.3897, Val Loss: 0.3922
[2025-09-28 20:08:23,313][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3448263461582931), 'mae': 0.2556450664997101, 'accuracy': np.float64(0.8365213515136046), 'precision': np.float64(0.8020752671519281), 'recall': np.float64(0.10488689065759361), 'f1': np.float64(0.18551420281548878)}
[2025-09-28 20:08:23,313][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3466366700898336), 'mae': 0.25512203574180603, 'accuracy': np.float64(0.8346590337010773), 'precision': np.float64(0.7798408488063661), 'recall': np.float64(0.09530756139071238), 'f1': np.float64(0.16985628656026577)}
[2025-09-28 20:08:23,320][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:08:27,854][__main__][INFO] - Epoch 9/20: Train Loss: 0.3892, Val Loss: 0.3929
[2025-09-28 20:08:27,854][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34463121430166527), 'mae': 0.2552417814731598, 'accuracy': np.float64(0.8365429205146364), 'precision': np.float64(0.8003074558032283), 'recall': np.float64(0.10543370395123236), 'f1': np.float64(0.18632117676532695)}
[2025-09-28 20:08:27,854][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34672637410181434), 'mae': 0.2570245563983917, 'accuracy': np.float64(0.834040533348676), 'precision': np.float64(0.7643564356435644), 'recall': np.float64(0.0938487721857525), 'f1': np.float64(0.16717193590298832)}
[2025-09-28 20:08:32,816][__main__][INFO] - Epoch 10/20: Train Loss: 0.3889, Val Loss: 0.3917
[2025-09-28 20:08:32,816][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3444358204790456), 'mae': 0.25495633482933044, 'accuracy': np.float64(0.8367873691929958), 'precision': np.float64(0.8021894480766307), 'recall': np.float64(0.10685136804585131), 'f1': np.float64(0.18858347928655683)}
[2025-09-28 20:08:32,816][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3451200730138937), 'mae': 0.2629789412021637, 'accuracy': np.float64(0.8365433022165326), 'precision': np.float64(0.7543035993740219), 'recall': np.float64(0.11718939946511063), 'f1': np.float64(0.20286195286195285)}
[2025-09-28 20:08:32,824][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:08:37,600][__main__][INFO] - Epoch 11/20: Train Loss: 0.3886, Val Loss: 0.3917
[2025-09-28 20:08:37,601][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3442939550952431), 'mae': 0.25489962100982666, 'accuracy': np.float64(0.8366148171847421), 'precision': np.float64(0.7935416355210047), 'recall': np.float64(0.10749944306053426), 'f1': np.float64(0.1893482681125816)}
[2025-09-28 20:08:37,601][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34573006390283434), 'mae': 0.25924739241600037, 'accuracy': np.float64(0.8358097320311264), 'precision': np.float64(0.7546857772877619), 'recall': np.float64(0.11094902342167112), 'f1': np.float64(0.19345721755104925)}
[2025-09-28 20:08:42,009][__main__][INFO] - Epoch 12/20: Train Loss: 0.3886, Val Loss: 0.3909
[2025-09-28 20:08:42,009][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34427184894929436), 'mae': 0.2549862563610077, 'accuracy': np.float64(0.8371180938754822), 'precision': np.float64(0.8028294862248697), 'recall': np.float64(0.10918038762986816), 'f1': np.float64(0.19221992440989805)}
[2025-09-28 20:08:42,009][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3461266848563437), 'mae': 0.25403258204460144, 'accuracy': np.float64(0.8345008126806956), 'precision': np.float64(0.7634408602150538), 'recall': np.float64(0.09781992057703218), 'f1': np.float64(0.17341954022988507)}
[2025-09-28 20:08:42,017][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:08:46,584][__main__][INFO] - Epoch 13/20: Train Loss: 0.3882, Val Loss: 0.3914
[2025-09-28 20:08:46,584][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34411406744715306), 'mae': 0.25466352701187134, 'accuracy': np.float64(0.8370246282043448), 'precision': np.float64(0.794834379104042), 'recall': np.float64(0.11031451890556332), 'f1': np.float64(0.1937399964431798)}
[2025-09-28 20:08:46,584][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3464422137940906), 'mae': 0.25333505868911743, 'accuracy': np.float64(0.8337240913079125), 'precision': np.float64(0.7658703071672355), 'recall': np.float64(0.09093119377583272), 'f1': np.float64(0.1625615763546798)}
[2025-09-28 20:08:50,974][__main__][INFO] - Epoch 14/20: Train Loss: 0.3885, Val Loss: 0.3914
[2025-09-28 20:08:50,974][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34423285946735976), 'mae': 0.254607230424881, 'accuracy': np.float64(0.837179206045072), 'precision': np.float64(0.8026081802015412), 'recall': np.float64(0.10968669623508921), 'f1': np.float64(0.19299777282850777)}
[2025-09-28 20:08:50,974][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3452236816483565), 'mae': 0.26087433099746704, 'accuracy': np.float64(0.8365720696747839), 'precision': np.float64(0.7605333333333333), 'recall': np.float64(0.11556852257071075), 'f1': np.float64(0.20064724919093851)}
[2025-09-28 20:08:55,855][__main__][INFO] - Epoch 15/20: Train Loss: 0.3887, Val Loss: 0.3916
[2025-09-28 20:08:55,856][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3443193272626808), 'mae': 0.25500085949897766, 'accuracy': np.float64(0.8368736451971227), 'precision': np.float64(0.7952163000147645), 'recall': np.float64(0.10907912590882395), 'f1': np.float64(0.1918432769367765)}
[2025-09-28 20:08:55,856][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3466642027069676), 'mae': 0.2539003789424896, 'accuracy': np.float64(0.833407649267149), 'precision': np.float64(0.7690120824449183), 'recall': np.float64(0.08768943998703299), 'f1': np.float64(0.15742761530627095)}
[2025-09-28 20:09:00,390][__main__][INFO] - Epoch 16/20: Train Loss: 0.3888, Val Loss: 0.3909
[2025-09-28 20:09:00,390][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34445999256329823), 'mae': 0.2550015449523926, 'accuracy': np.float64(0.836877240030628), 'precision': np.float64(0.7967359050445104), 'recall': np.float64(0.10875508840148247), 'f1': np.float64(0.1913858545538785)}
[2025-09-28 20:09:00,390][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3457460753920787), 'mae': 0.2567715346813202, 'accuracy': np.float64(0.8348891733670871), 'precision': np.float64(0.7742346938775511), 'recall': np.float64(0.09838722749007213), 'f1': np.float64(0.17458833680880131)}
[2025-09-28 20:09:04,996][__main__][INFO] - Epoch 17/20: Train Loss: 0.3863, Val Loss: 0.3896
[2025-09-28 20:09:04,996][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3432150927114944), 'mae': 0.25433114171028137, 'accuracy': np.float64(0.8368269123615539), 'precision': np.float64(0.8024279210925644), 'recall': np.float64(0.10709439617635741), 'f1': np.float64(0.18896849929422693)}
[2025-09-28 20:09:04,996][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3449695368461575), 'mae': 0.2564525902271271, 'accuracy': np.float64(0.8356515110107446), 'precision': np.float64(0.7722122838401908), 'recall': np.float64(0.1049517789123916), 'f1': np.float64(0.1847888127853881)}
[2025-09-28 20:09:05,004][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:09:09,975][__main__][INFO] - Epoch 18/20: Train Loss: 0.3856, Val Loss: 0.3894
[2025-09-28 20:09:09,976][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3428443987392303), 'mae': 0.2539725601673126, 'accuracy': np.float64(0.8373194045517782), 'precision': np.float64(0.8069992553983619), 'recall': np.float64(0.10974745326771573), 'f1': np.float64(0.19321828424730797)}
[2025-09-28 20:09:09,976][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34511338055361634), 'mae': 0.2550565302371979, 'accuracy': np.float64(0.8355220574486141), 'precision': np.float64(0.775609756097561), 'recall': np.float64(0.10308777048383175), 'f1': np.float64(0.181987266614207)}
[2025-09-28 20:09:09,984][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:09:14,406][__main__][INFO] - Epoch 19/20: Train Loss: 0.3852, Val Loss: 0.3892
[2025-09-28 20:09:14,406][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34264882314054906), 'mae': 0.2535932660102844, 'accuracy': np.float64(0.837743594905402), 'precision': np.float64(0.8096072419331289), 'recall': np.float64(0.11229924863802986), 'f1': np.float64(0.1972397111656529)}
[2025-09-28 20:09:14,406][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34487880338498283), 'mae': 0.25629958510398865, 'accuracy': np.float64(0.8356658947398703), 'precision': np.float64(0.7713776722090261), 'recall': np.float64(0.10527595429127158), 'f1': np.float64(0.1852670612565072)}
[2025-09-28 20:09:14,414][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 20:09:19,301][__main__][INFO] - Epoch 20/20: Train Loss: 0.3850, Val Loss: 0.3892
[2025-09-28 20:09:19,301][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3425375297791379), 'mae': 0.2536162734031677, 'accuracy': np.float64(0.8377040517368438), 'precision': np.float64(0.8073234524847428), 'recall': np.float64(0.11252202442432711), 'f1': np.float64(0.19751506425638565)}
[2025-09-28 20:09:19,301][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3454020638632837), 'mae': 0.25288984179496765, 'accuracy': np.float64(0.8343713591185651), 'precision': np.float64(0.7746666666666666), 'recall': np.float64(0.09417294756463247), 'f1': np.float64(0.16793120890237734)}
[2025-09-28 20:09:19,301][__main__][INFO] - Training completed!
[2025-09-28 20:09:19,301][__main__][INFO] - Best validation loss: 0.3892
