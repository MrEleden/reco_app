[2025-09-28 20:48:00,127][__main__][INFO] - Configuration:
[2025-09-28 20:48:00,130][__main__][INFO] - model:
  name: hybrid
  type: HybridModel
  embedding_dim: 50
  genre_embedding_dim: 32
  collaborative_weight: 0.7
  content_weight: 0.3
  fusion_dims:
  - 256
  - 128
  dropout: 0.2
  description: Combined collaborative and content-based approach
train:
  name: default
  batch_size: 256
  learning_rate: 0.01
  weight_decay: 0.0001
  epochs: 20
  patience: 5
  min_delta: 0.0001
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto

[2025-09-28 20:48:00,131][__main__][INFO] - Using device: cuda
[2025-09-28 20:48:00,131][__main__][INFO] - Loading data...
[2025-09-28 20:48:00,188][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-28 20:48:00,190][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-28 20:48:01,187][__main__][INFO] - Creating model: HybridModel
[2025-09-28 20:48:01,360][__main__][INFO] - Model created with 549,154 parameters
[2025-09-28 20:48:01,361][__main__][INFO] - Starting training...
[2025-09-28 20:48:12,407][__main__][INFO] - Epoch 1/20: Train Loss: 0.3750, Val Loss: 0.3588
[2025-09-28 20:48:12,408][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33869795737319336), 'mae': 0.2322721630334854, 'accuracy': np.float64(0.844451554226266), 'precision': np.float64(0.6403456358873006), 'recall': np.float64(0.28215565951758914), 'f1': np.float64(0.39171141788736746)}
[2025-09-28 20:48:12,408][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3326842786377497), 'mae': 0.2257690280675888, 'accuracy': np.float64(0.8457057376695482), 'precision': np.float64(0.5831270627062707), 'recall': np.float64(0.4582218980468433), 'f1': np.float64(0.5131835715906512)}
[2025-09-28 20:48:12,416][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:48:22,311][__main__][INFO] - Epoch 2/20: Train Loss: 0.3493, Val Loss: 0.3525
[2025-09-28 20:48:22,311][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32797269465312817), 'mae': 0.2174062430858612, 'accuracy': np.float64(0.8515118072306481), 'precision': np.float64(0.6373413198107749), 'recall': np.float64(0.3792656499989874), 'f1': np.float64(0.4755459624174708)}
[2025-09-28 20:48:22,312][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3304387441950464), 'mae': 0.22047576308250427, 'accuracy': np.float64(0.8455906678365434), 'precision': np.float64(0.5850296861747244), 'recall': np.float64(0.44719993516492423), 'f1': np.float64(0.5069128657388269)}
[2025-09-28 20:48:22,321][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:48:34,255][__main__][INFO] - Epoch 3/20: Train Loss: 0.3446, Val Loss: 0.3519
[2025-09-28 20:48:34,256][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32629937974804807), 'mae': 0.2149428427219391, 'accuracy': np.float64(0.8518281525791133), 'precision': np.float64(0.6337497131241598), 'recall': np.float64(0.39147781355691924), 'f1': np.float64(0.4839880818247828)}
[2025-09-28 20:48:34,256][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.330442160129606), 'mae': 0.2153749018907547, 'accuracy': np.float64(0.8456338190239201), 'precision': np.float64(0.587251601693995), 'recall': np.float64(0.4382851122457249), 'f1': np.float64(0.501949136810841)}
[2025-09-28 20:48:34,270][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:48:49,683][__main__][INFO] - Epoch 4/20: Train Loss: 0.3430, Val Loss: 0.3493
[2025-09-28 20:48:49,683][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3258697229542677), 'mae': 0.21358418464660645, 'accuracy': np.float64(0.8521013599255151), 'precision': np.float64(0.6412763767370047), 'recall': np.float64(0.37851631326326024), 'f1': np.float64(0.4760449300832888)}
[2025-09-28 20:48:49,683][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3291373643729461), 'mae': 0.2248791754245758, 'accuracy': np.float64(0.8475900061850036), 'precision': np.float64(0.6000918800964741), 'recall': np.float64(0.4234540886619661), 'f1': np.float64(0.49653140739332896)}
[2025-09-28 20:48:49,699][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:49:04,750][__main__][INFO] - Epoch 5/20: Train Loss: 0.3424, Val Loss: 0.3474
[2025-09-28 20:49:04,750][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3257616741601907), 'mae': 0.21325604617595673, 'accuracy': np.float64(0.8524069207734644), 'precision': np.float64(0.6469549244029956), 'recall': np.float64(0.37090143184073554), 'f1': np.float64(0.47149385338224886)}
[2025-09-28 20:49:04,750][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32777545112297757), 'mae': 0.21020613610744476, 'accuracy': np.float64(0.8489420767228112), 'precision': np.float64(0.6188381420623625), 'recall': np.float64(0.387632709295729), 'f1': np.float64(0.47667929041259716)}
[2025-09-28 20:49:04,767][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:49:20,665][__main__][INFO] - Epoch 6/20: Train Loss: 0.3425, Val Loss: 0.3481
[2025-09-28 20:49:20,665][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32572943552118144), 'mae': 0.21308648586273193, 'accuracy': np.float64(0.851874885414682), 'precision': np.float64(0.6494841589229531), 'recall': np.float64(0.3595398667395751), 'f1': np.float64(0.46285408872260825)}
[2025-09-28 20:49:20,665][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3287500037530529), 'mae': 0.21447749435901642, 'accuracy': np.float64(0.8464249241258288), 'precision': np.float64(0.6013167520117044), 'recall': np.float64(0.399708242159008), 'f1': np.float64(0.4802103110851467)}
[2025-09-28 20:49:32,617][__main__][INFO] - Epoch 7/20: Train Loss: 0.3424, Val Loss: 0.3500
[2025-09-28 20:49:32,618][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3257152765010701), 'mae': 0.21290543675422668, 'accuracy': np.float64(0.8517814197435446), 'precision': np.float64(0.6481306371835903), 'recall': np.float64(0.36091702614577637), 'f1': np.float64(0.46364783474041593)}
[2025-09-28 20:49:32,618][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32928391563463927), 'mae': 0.22089266777038574, 'accuracy': np.float64(0.8486831695985502), 'precision': np.float64(0.6630805092343554), 'recall': np.float64(0.299700137774536), 'f1': np.float64(0.41281536057155616)}
[2025-09-28 20:49:44,006][__main__][INFO] - Epoch 8/20: Train Loss: 0.3421, Val Loss: 0.3523
[2025-09-28 20:49:44,007][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3258884249066661), 'mae': 0.21304583549499512, 'accuracy': np.float64(0.8513284707218786), 'precision': np.float64(0.6503674816259187), 'recall': np.float64(0.35125665795815864), 'f1': np.float64(0.4561509632454468)}
[2025-09-28 20:49:44,007][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3294900022387893), 'mae': 0.20650842785835266, 'accuracy': np.float64(0.8479639831422695), 'precision': np.float64(0.6556396269575928), 'recall': np.float64(0.30196936542669583), 'f1': np.float64(0.41349461768949064)}
[2025-09-28 20:49:54,777][__main__][INFO] - Epoch 9/20: Train Loss: 0.3421, Val Loss: 0.3466
[2025-09-28 20:49:54,777][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32579384100205055), 'mae': 0.21290498971939087, 'accuracy': np.float64(0.8511738928811512), 'precision': np.float64(0.6500056414306669), 'recall': np.float64(0.3500212649614193), 'f1': np.float64(0.4550193507621831)}
[2025-09-28 20:49:54,778][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32795653105532846), 'mae': 0.22052304446697235, 'accuracy': np.float64(0.8491146814723185), 'precision': np.float64(0.6556135330752398), 'recall': np.float64(0.3156657751843747), 'f1': np.float64(0.42614879649890586)}
[2025-09-28 20:49:54,797][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:50:08,643][__main__][INFO] - Epoch 10/20: Train Loss: 0.3429, Val Loss: 0.3536
[2025-09-28 20:50:08,643][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32602678144111735), 'mae': 0.21344442665576935, 'accuracy': np.float64(0.8515513503992063), 'precision': np.float64(0.6543662617465047), 'recall': np.float64(0.34692265629746644), 'f1': np.float64(0.45344451062140156)}
[2025-09-28 20:50:08,644][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33065378902043324), 'mae': 0.23513831198215485, 'accuracy': np.float64(0.8477626109345109), 'precision': np.float64(0.6009897571642306), 'recall': np.float64(0.42321095712780615), 'f1': np.float64(0.49667110519307583)}
[2025-09-28 20:50:20,873][__main__][INFO] - Epoch 11/20: Train Loss: 0.3424, Val Loss: 0.3491
[2025-09-28 20:50:20,874][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32575629936928263), 'mae': 0.21287938952445984, 'accuracy': np.float64(0.851749066241997), 'precision': np.float64(0.6504122148693112), 'recall': np.float64(0.3562994916661604), 'f1': np.float64(0.460393059953419)}
[2025-09-28 20:50:20,874][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3288546918204876), 'mae': 0.21825604140758514, 'accuracy': np.float64(0.8478776807675158), 'precision': np.float64(0.6144656538111933), 'recall': np.float64(0.3834994732150093), 'f1': np.float64(0.4722554890219561)}
[2025-09-28 20:50:33,501][__main__][INFO] - Epoch 12/20: Train Loss: 0.3422, Val Loss: 0.3468
[2025-09-28 20:50:33,502][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3259183160799784), 'mae': 0.21303614974021912, 'accuracy': np.float64(0.8509510132038235), 'precision': np.float64(0.6487390536325027), 'recall': np.float64(0.34957571338882476), 'f1': np.float64(0.4543324910507475)}
[2025-09-28 20:50:33,502][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3275820235919477), 'mae': 0.21663370728492737, 'accuracy': np.float64(0.8499345540324784), 'precision': np.float64(0.6445253260539885), 'recall': np.float64(0.3444363400599724), 'f1': np.float64(0.44895156604869807)}
[2025-09-28 20:50:45,579][__main__][INFO] - Epoch 13/20: Train Loss: 0.3423, Val Loss: 0.3485
[2025-09-28 20:50:45,579][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32574429153730833), 'mae': 0.21278740465641022, 'accuracy': np.float64(0.8517059282399335), 'precision': np.float64(0.6562800538565109), 'recall': np.float64(0.34550499220284747), 'f1': np.float64(0.45268800084912164)}
[2025-09-28 20:50:45,579][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32883551283186746), 'mae': 0.2182869166135788, 'accuracy': np.float64(0.8483379600995354), 'precision': np.float64(0.60015623256333), 'recall': np.float64(0.4358537969041251), 'f1': np.float64(0.5049765258215962)}
[2025-09-28 20:50:58,223][__main__][INFO] - Epoch 14/20: Train Loss: 0.3301, Val Loss: 0.3415
[2025-09-28 20:50:58,223][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3207347343191187), 'mae': 0.20667709410190582, 'accuracy': np.float64(0.8551497787379978), 'precision': np.float64(0.6594347902404775), 'recall': np.float64(0.3804200336188914), 'f1': np.float64(0.48249467005728086)}
[2025-09-28 20:50:58,224][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3254362021739584), 'mae': 0.2196437567472458, 'accuracy': np.float64(0.852034578484818), 'precision': np.float64(0.625920471281296), 'recall': np.float64(0.41332360807196694), 'f1': np.float64(0.4978767022990189)}
[2025-09-28 20:50:58,236][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:51:10,541][__main__][INFO] - Epoch 15/20: Train Loss: 0.3294, Val Loss: 0.3414
[2025-09-28 20:51:10,541][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3207989348615351), 'mae': 0.20687995851039886, 'accuracy': np.float64(0.8553367100802727), 'precision': np.float64(0.6595410248349576), 'recall': np.float64(0.3824047633513579), 'f1': np.float64(0.4841166064148912)}
[2025-09-28 20:51:10,542][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32563733368577547), 'mae': 0.2044067531824112, 'accuracy': np.float64(0.8504379845518749), 'precision': np.float64(0.6272119543845851), 'recall': np.float64(0.387794796985169), 'f1': np.float64(0.4792668269230769)}
[2025-09-28 20:51:10,558][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:51:23,674][__main__][INFO] - Epoch 16/20: Train Loss: 0.3286, Val Loss: 0.3423
[2025-09-28 20:51:23,674][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32061225542315486), 'mae': 0.2064022272825241, 'accuracy': np.float64(0.8553870377493467), 'precision': np.float64(0.6589085351026505), 'recall': np.float64(0.38414646495331833), 'f1': np.float64(0.4853385190113095)}
[2025-09-28 20:51:23,675][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32585232323035945), 'mae': 0.2117018699645996, 'accuracy': np.float64(0.8503804496353725), 'precision': np.float64(0.6110283159463488), 'recall': np.float64(0.43196369235756543), 'f1': np.float64(0.5061247744753584)}
[2025-09-28 20:51:35,606][__main__][INFO] - Epoch 17/20: Train Loss: 0.3278, Val Loss: 0.3419
[2025-09-28 20:51:35,608][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32051566124231845), 'mae': 0.20625989139080048, 'accuracy': np.float64(0.8552180805745981), 'precision': np.float64(0.6555259380766865), 'recall': np.float64(0.3884804666140106), 'f1': np.float64(0.4878495403044292)}
[2025-09-28 20:51:35,608][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32513588714630753), 'mae': 0.20563791692256927, 'accuracy': np.float64(0.8518619737353106), 'precision': np.float64(0.6528776978417267), 'recall': np.float64(0.3530269876002918), 'f1': np.float64(0.45826100678554527)}
[2025-09-28 20:51:48,491][__main__][INFO] - Epoch 18/20: Train Loss: 0.3274, Val Loss: 0.3432
[2025-09-28 20:51:48,491][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32047575767663206), 'mae': 0.2060914784669876, 'accuracy': np.float64(0.855379848082336), 'precision': np.float64(0.6575493472045196), 'recall': np.float64(0.3865767462583794), 'f1': np.float64(0.48690151263933873)}
[2025-09-28 20:51:48,491][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3251600618702671), 'mae': 0.2091958075761795, 'accuracy': np.float64(0.8505530543848798), 'precision': np.float64(0.6295360893260668), 'recall': np.float64(0.3838236485938893), 'f1': np.float64(0.47689054475883597)}
[2025-09-28 20:52:00,833][__main__][INFO] - Epoch 19/20: Train Loss: 0.3271, Val Loss: 0.3426
[2025-09-28 20:52:00,835][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32047142180208327), 'mae': 0.20605097711086273, 'accuracy': np.float64(0.8556027277596638), 'precision': np.float64(0.6598729210791292), 'recall': np.float64(0.3848958016890455), 'f1': np.float64(0.4861981631661081)}
[2025-09-28 20:52:00,835][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3257679522611117), 'mae': 0.2155364453792572, 'accuracy': np.float64(0.8516030666110496), 'precision': np.float64(0.6312646065956894), 'recall': np.float64(0.39403517302860847), 'f1': np.float64(0.4852053290753954)}
[2025-09-28 20:52:11,739][__main__][INFO] - Epoch 20/20: Train Loss: 0.3163, Val Loss: 0.3410
[2025-09-28 20:52:11,739][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3165954095053112), 'mae': 0.201399028301239, 'accuracy': np.float64(0.8582880683881126), 'precision': np.float64(0.6677110706825685), 'recall': np.float64(0.40138120987504305), 'f1': np.float64(0.5013723927699567)}
[2025-09-28 20:52:11,739][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32335371646137423), 'mae': 0.20718957483768463, 'accuracy': np.float64(0.8540770680206551), 'precision': np.float64(0.6476446837146702), 'recall': np.float64(0.3899829807926088), 'f1': np.float64(0.4868228033790277)}
[2025-09-28 20:52:11,753][__main__][INFO] - New best model saved: best_model_hybrid.pth
[2025-09-28 20:52:11,753][__main__][INFO] - Training completed!
[2025-09-28 20:52:11,753][__main__][INFO] - Best validation loss: 0.3410
