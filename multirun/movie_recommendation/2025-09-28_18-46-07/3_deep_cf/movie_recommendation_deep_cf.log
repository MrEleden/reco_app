[2025-09-28 18:47:17,557][__main__][INFO] - Configuration:
[2025-09-28 18:47:17,558][__main__][INFO] - model:
  name: deep_cf
  type: DeepCollaborativeFiltering
  embedding_dim: 64
  hidden_dims:
  - 256
  - 128
  - 64
  dropout: 0.4
  batch_norm: true
  activation: relu
  description: Deep neural network for collaborative filtering
train:
  name: default
  batch_size: 256
  learning_rate: 0.01
  weight_decay: 0.0001
  epochs: 20
  patience: 5
  min_delta: 0.0001
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: false
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto

[2025-09-28 18:47:17,560][__main__][INFO] - Using device: cpu
[2025-09-28 18:47:17,560][__main__][INFO] - Loading data...
[2025-09-28 18:47:17,597][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-28 18:47:17,597][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-28 18:47:18,294][__main__][INFO] - Creating model: DeepCollaborativeFiltering
[2025-09-28 18:47:18,298][__main__][INFO] - Model created with 736,769 parameters
[2025-09-28 18:47:18,300][__main__][INFO] - Starting training...
[2025-09-28 18:47:29,936][__main__][INFO] - Epoch 1/20: Train Loss: 0.3887, Val Loss: 0.3721
[2025-09-28 18:47:29,936][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34453336364720555), 'mae': 0.23870792984962463, 'accuracy': np.float64(0.8381570007585099), 'precision': np.float64(0.6195258478761936), 'recall': np.float64(0.2286287137736193), 'f1': np.float64(0.33399902365419604)}
[2025-09-28 18:47:29,936][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3380355964967319), 'mae': 0.24332213401794434, 'accuracy': np.float64(0.8443105159443637), 'precision': np.float64(0.6058996225359988), 'recall': np.float64(0.3512440230164519), 'f1': np.float64(0.44469525959367945)}
[2025-09-28 18:47:29,944][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 18:48:10,804][__main__][INFO] - Epoch 2/20: Train Loss: 0.3645, Val Loss: 0.3630
[2025-09-28 18:48:10,805][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3343093584818423), 'mae': 0.22423022985458374, 'accuracy': np.float64(0.8434306215107648), 'precision': np.float64(0.6360196215837421), 'recall': np.float64(0.2757154140591774), 'f1': np.float64(0.3846740696787319)}
[2025-09-28 18:48:10,805][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3353852567814031), 'mae': 0.21372294425964355, 'accuracy': np.float64(0.8397221063532931), 'precision': np.float64(0.7214814814814815), 'recall': np.float64(0.15787340951454737), 'f1': np.float64(0.25905977791076534)}
[2025-09-28 18:48:10,813][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 18:49:10,807][__main__][INFO] - Epoch 3/20: Train Loss: 0.3579, Val Loss: 0.3540
[2025-09-28 18:49:10,807][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3323241905012856), 'mae': 0.22137312591075897, 'accuracy': np.float64(0.8436463115210819), 'precision': np.float64(0.6340885262342162), 'recall': np.float64(0.2817101079449946), 'f1': np.float64(0.3901057295902628)}
[2025-09-28 18:49:10,808][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33096653262513864), 'mae': 0.2251480519771576, 'accuracy': np.float64(0.8470865756656071), 'precision': np.float64(0.599025974025974), 'recall': np.float64(0.41867250182348653), 'f1': np.float64(0.4928683871583266)}
[2025-09-28 18:49:10,815][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 18:50:11,567][__main__][INFO] - Epoch 4/20: Train Loss: 0.3547, Val Loss: 0.3528
[2025-09-28 18:50:11,567][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33065938839253584), 'mae': 0.21937841176986694, 'accuracy': np.float64(0.8461591001412769), 'precision': np.float64(0.6383121795410608), 'recall': np.float64(0.3075926038438949), 'f1': np.float64(0.41513714449713685)}
[2025-09-28 18:50:11,567][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33121204293704637), 'mae': 0.22223153710365295, 'accuracy': np.float64(0.8449577837550163), 'precision': np.float64(0.6931649331352154), 'recall': np.float64(0.22684172137126185), 'f1': np.float64(0.34182084630884774)}
[2025-09-28 18:50:11,576][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 18:51:11,321][__main__][INFO] - Epoch 5/20: Train Loss: 0.3534, Val Loss: 0.3556
[2025-09-28 18:51:11,321][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33033641889183546), 'mae': 0.21892596781253815, 'accuracy': np.float64(0.8463927643191206), 'precision': np.float64(0.6468560823648977), 'recall': np.float64(0.29647406687324057), 'f1': np.float64(0.4065937118097989)}
[2025-09-28 18:51:11,321][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33196808831329316), 'mae': 0.22651980817317963, 'accuracy': np.float64(0.8434043410094502), 'precision': np.float64(0.6985776805251641), 'recall': np.float64(0.20698597941486344), 'f1': np.float64(0.31934979681150355)}
[2025-09-28 18:52:11,492][__main__][INFO] - Epoch 6/20: Train Loss: 0.3519, Val Loss: 0.3504
[2025-09-28 18:52:11,493][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32978082845489765), 'mae': 0.21816855669021606, 'accuracy': np.float64(0.8462274019778774), 'precision': np.float64(0.6466172093643108), 'recall': np.float64(0.2947931223039067), 'f1': np.float64(0.40496327620743383)}
[2025-09-28 18:52:11,493][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32915378688208285), 'mae': 0.22232620418071747, 'accuracy': np.float64(0.8486256346820477), 'precision': np.float64(0.6435690555291884), 'recall': np.float64(0.3296863603209336), 'f1': np.float64(0.43601286173633436)}
[2025-09-28 18:52:11,503][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 18:53:11,451][__main__][INFO] - Epoch 7/20: Train Loss: 0.3515, Val Loss: 0.3508
[2025-09-28 18:53:11,452][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32969176800392375), 'mae': 0.217965766787529, 'accuracy': np.float64(0.8468457133407866), 'precision': np.float64(0.6469133660144896), 'recall': np.float64(0.3020029568422545), 'f1': np.float64(0.41177445186944267)}
[2025-09-28 18:53:11,452][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32992180954582256), 'mae': 0.2177533656358719, 'accuracy': np.float64(0.8483954950160378), 'precision': np.float64(0.6396088778519323), 'recall': np.float64(0.3339816840910933), 'f1': np.float64(0.438824406346502)}
[2025-09-28 18:54:10,612][__main__][INFO] - Epoch 8/20: Train Loss: 0.3519, Val Loss: 0.3505
[2025-09-28 18:54:10,612][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32983487663458955), 'mae': 0.21801938116550446, 'accuracy': np.float64(0.8462238071443721), 'precision': np.float64(0.644927536231884), 'recall': np.float64(0.2974056747068473), 'f1': np.float64(0.407085533702025)}
[2025-09-28 18:54:10,612][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3297230769121069), 'mae': 0.21675673127174377, 'accuracy': np.float64(0.8486400184111733), 'precision': np.float64(0.6469255663430421), 'recall': np.float64(0.32401329119053407), 'f1': np.float64(0.4317727739078784)}
[2025-09-28 18:55:07,213][__main__][INFO] - Epoch 9/20: Train Loss: 0.3512, Val Loss: 0.3549
[2025-09-28 18:55:07,214][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32940533029659314), 'mae': 0.21749822795391083, 'accuracy': np.float64(0.8471980070243047), 'precision': np.float64(0.6455411988985384), 'recall': np.float64(0.308605221054337), 'f1': np.float64(0.41758241758241754)}
[2025-09-28 18:55:07,214][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3313311544908122), 'mae': 0.21018832921981812, 'accuracy': np.float64(0.8472447966859888), 'precision': np.float64(0.6719343868773755), 'recall': np.float64(0.27222627441445824), 'f1': np.float64(0.3874726035298189)}
[2025-09-28 18:55:48,578][__main__][INFO] - Epoch 10/20: Train Loss: 0.3512, Val Loss: 0.3600
[2025-09-28 18:55:48,578][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3295708883980628), 'mae': 0.21772661805152893, 'accuracy': np.float64(0.8466911355000594), 'precision': np.float64(0.645030600810275), 'recall': np.float64(0.303096583429532), 'f1': np.float64(0.41240579230907015)}
[2025-09-28 18:55:48,580][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33164817927263474), 'mae': 0.20226630568504333, 'accuracy': np.float64(0.8456194352947946), 'precision': np.float64(0.5911050601316088), 'recall': np.float64(0.4222384309911662), 'f1': np.float64(0.49260152224270787)}
[2025-09-28 18:56:32,034][__main__][INFO] - Epoch 11/20: Train Loss: 0.3359, Val Loss: 0.3421
[2025-09-28 18:56:32,034][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.32309273436947794), 'mae': 0.20946602523326874, 'accuracy': np.float64(0.8531366719750375), 'precision': np.float64(0.6538058974266431), 'recall': np.float64(0.36687121534317596), 'f1': np.float64(0.4700067458876031)}
[2025-09-28 18:56:32,034][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32517775067171734), 'mae': 0.2062969207763672, 'accuracy': np.float64(0.8511859384664068), 'precision': np.float64(0.629735711495899), 'recall': np.float64(0.39200907691060866), 'f1': np.float64(0.48321678321678324)}
[2025-09-28 18:56:32,042][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 18:57:32,993][__main__][INFO] - Epoch 12/20: Train Loss: 0.3339, Val Loss: 0.3416
[2025-09-28 18:57:32,994][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3225129536681235), 'mae': 0.2088085412979126, 'accuracy': np.float64(0.8544631655384881), 'precision': np.float64(0.66055178390871), 'recall': np.float64(0.370455880268141), 'f1': np.float64(0.47469151020514083)}
[2025-09-28 18:57:32,994][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32570983231981865), 'mae': 0.216671422123909, 'accuracy': np.float64(0.8515455316945472), 'precision': np.float64(0.6384847653033214), 'recall': np.float64(0.37701596563740986), 'f1': np.float64(0.47408917197452227)}
[2025-09-28 18:57:33,001][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 18:58:32,798][__main__][INFO] - Epoch 13/20: Train Loss: 0.3327, Val Loss: 0.3438
[2025-09-28 18:58:32,798][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3221660228900592), 'mae': 0.20833748579025269, 'accuracy': np.float64(0.8547148038838581), 'precision': np.float64(0.6600928903179707), 'recall': np.float64(0.374182311602568), 'f1': np.float64(0.47761965695968567)}
[2025-09-28 18:58:32,799][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32599900284421574), 'mae': 0.21008692681789398, 'accuracy': np.float64(0.8521784157760741), 'precision': np.float64(0.6637027627818355), 'recall': np.float64(0.3387632709295729), 'f1': np.float64(0.44857004882760104)}
