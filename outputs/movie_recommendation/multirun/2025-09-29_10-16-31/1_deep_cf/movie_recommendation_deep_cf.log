[2025-09-29 10:20:18,940][__main__][INFO] - Configuration:
[2025-09-29 10:20:18,942][__main__][INFO] - model:
  name: deep_cf
  type: DeepCollaborativeFiltering
  embedding_dim: 64
  hidden_dims:
  - 256
  - 128
  - 64
  dropout: 0.1
  batch_norm: true
  activation: relu
  description: Deep neural network for collaborative filtering
train:
  name: production
  batch_size: 512
  learning_rate: 0.0001
  weight_decay: 0.0001
  epochs: 100
  patience: 5
  min_delta: 1.0e-05
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: true
  scheduler:
    type: cosine
    T_max: 100
    eta_min: 1.0e-06
  loss:
    type: bce
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@5
  - precision@10
  - precision@20
  - recall@5
  - recall@10
  - recall@20
  - ndcg@10
  - f1
  top_k:
  - 5
  - 10
  - 20
  - 50
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-29 10:20:19,063][__main__][INFO] - MLflow run started: 3f5e1a2b3b2f4f06ba4b99563dedc238
[2025-09-29 10:20:19,063][__main__][INFO] - Using device: cuda
[2025-09-29 10:20:19,101][__main__][INFO] - Loading data...
[2025-09-29 10:20:19,138][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 10:20:19,138][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 10:20:19,813][__main__][INFO] - Creating model: DeepCollaborativeFiltering
[2025-09-29 10:20:19,820][__main__][INFO] - Model created with 736,769 parameters
[2025-09-29 10:20:19,871][__main__][INFO] - Starting training...
[2025-09-29 10:20:23,543][__main__][INFO] - Epoch 1/100: Train Loss: 0.4309, Val Loss: 0.3460
[2025-09-29 10:20:23,543][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3713440302053472), 'mae': 0.2846248745918274, 'accuracy': np.float64(0.8344830809161073), 'precision': np.float64(0.6136022897642088), 'recall': np.float64(0.18235210725641493), 'f1': np.float64(0.28115095783047883)}
[2025-09-29 10:20:23,543][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3271042979055728), 'mae': 0.21170532703399658, 'accuracy': np.float64(0.8483954950160378), 'precision': np.float64(0.5924365430068852), 'recall': np.float64(0.4672177648107626), 'f1': np.float64(0.5224286361576801)}
[2025-09-29 10:20:23,789][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 10:20:27,878][__main__][INFO] - Epoch 2/100: Train Loss: 0.3240, Val Loss: 0.3434
[2025-09-29 10:20:27,878][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.31838301120379586), 'mae': 0.20307762920856476, 'accuracy': np.float64(0.8561886856210255), 'precision': np.float64(0.6273438773846405), 'recall': np.float64(0.46752536606112155), 'f1': np.float64(0.5357702349869451)}
[2025-09-29 10:20:27,880][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3250718899224948), 'mae': 0.20432955026626587, 'accuracy': np.float64(0.8502366123441163), 'precision': np.float64(0.6099509300467876), 'recall': np.float64(0.43317935002836533), 'f1': np.float64(0.5065870533598711)}
[2025-09-29 10:20:28,136][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 10:20:32,486][__main__][INFO] - Epoch 3/100: Train Loss: 0.3154, Val Loss: 0.3434
[2025-09-29 10:20:32,486][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3155932164949289), 'mae': 0.19927075505256653, 'accuracy': np.float64(0.8578854470355205), 'precision': np.float64(0.6415181138585394), 'recall': np.float64(0.4518703039876866), 'f1': np.float64(0.5302470382737027)}
[2025-09-29 10:20:32,488][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3244309592626614), 'mae': 0.20612242817878723, 'accuracy': np.float64(0.8520489622139436), 'precision': np.float64(0.6194299011052937), 'recall': np.float64(0.4314774292892455), 'f1': np.float64(0.5086462214579153)}
[2025-09-29 10:20:36,916][__main__][INFO] - Epoch 4/100: Train Loss: 0.3111, Val Loss: 0.3440
[2025-09-29 10:20:36,916][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3140255882625143), 'mae': 0.1974332630634308, 'accuracy': np.float64(0.8592838372690769), 'precision': np.float64(0.6555214444208031), 'recall': np.float64(0.4367620552078903), 'f1': np.float64(0.5242355000243084)}
[2025-09-29 10:20:36,916][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3238399889973393), 'mae': 0.20542410016059875, 'accuracy': np.float64(0.8529695208779828), 'precision': np.float64(0.6243100411039343), 'recall': np.float64(0.43082907853148555), 'f1': np.float64(0.5098302483935936)}
[2025-09-29 10:20:41,237][__main__][INFO] - Epoch 5/100: Train Loss: 0.3082, Val Loss: 0.3443
[2025-09-29 10:20:41,237][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3128769627516019), 'mae': 0.1961895376443863, 'accuracy': np.float64(0.8608404001768658), 'precision': np.float64(0.666302856430086), 'recall': np.float64(0.4327318387103307), 'f1': np.float64(0.524697648719995)}
[2025-09-29 10:20:41,237][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3233055790172029), 'mae': 0.20462575554847717, 'accuracy': np.float64(0.8537174747925147), 'precision': np.float64(0.6348377471092875), 'recall': np.float64(0.4138098711402869), 'f1': np.float64(0.501030320871357)}
[2025-09-29 10:20:46,802][__main__][INFO] - Epoch 6/100: Train Loss: 0.3064, Val Loss: 0.3456
[2025-09-29 10:20:46,802][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.31222652151335883), 'mae': 0.19527146220207214, 'accuracy': np.float64(0.8613616510351323), 'precision': np.float64(0.6728045778587641), 'recall': np.float64(0.42623083621929236), 'f1': np.float64(0.521857720250936)}
[2025-09-29 10:20:46,802][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32338038599065444), 'mae': 0.20486479997634888, 'accuracy': np.float64(0.8537893934381428), 'precision': np.float64(0.6360450563204005), 'recall': np.float64(0.41186481886700704), 'f1': np.float64(0.4999754045944217)}
[2025-09-29 10:20:52,865][__main__][INFO] - Epoch 7/100: Train Loss: 0.3053, Val Loss: 0.3473
[2025-09-29 10:20:52,865][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.31186519758380454), 'mae': 0.19496890902519226, 'accuracy': np.float64(0.8618793070598936), 'precision': np.float64(0.6744593432493551), 'recall': np.float64(0.42886364096644186), 'f1': np.float64(0.5243271349691733)}
[2025-09-29 10:20:52,865][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.323223505315807), 'mae': 0.2016196846961975, 'accuracy': np.float64(0.8541346029371575), 'precision': np.float64(0.6375125125125125), 'recall': np.float64(0.41291838884836696), 'f1': np.float64(0.5012050563179381)}
[2025-09-29 10:20:53,124][__main__][INFO] - Early stopping after 7 epochs
[2025-09-29 10:20:53,124][__main__][INFO] - Training completed!
[2025-09-29 10:20:53,124][__main__][INFO] - Best validation loss: 0.3434
[2025-09-29 10:20:56,172][__main__][INFO] - MLflow run completed
