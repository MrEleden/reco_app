[2025-09-29 09:17:01,871][__main__][INFO] - Configuration:
[2025-09-29 09:17:01,873][__main__][INFO] - model:
  name: collaborative
  type: CollaborativeFilteringModel
  embedding_dim: 50
  dropout: 0.2
  bias: true
  init_mean: 0.0
  init_std: 0.1
  description: Matrix factorization with user and movie embeddings
train:
  name: default
  batch_size: 256
  learning_rate: 0.05
  weight_decay: 0.0001
  epochs: 3
  patience: 5
  min_delta: 0.0001
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: sgd
  momentum: 0.9
  dampening: 0.0
  nesterov: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-29 09:17:02,231][__main__][INFO] - MLflow run started: 56d8936f8bc84d059d9d4651748fa36b
[2025-09-29 09:17:02,242][__main__][INFO] - Using device: cuda
[2025-09-29 09:17:02,260][__main__][INFO] - Loading data...
[2025-09-29 09:17:02,298][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 09:17:02,298][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 09:17:02,989][__main__][INFO] - Creating model: CollaborativeFilteringModel
[2025-09-29 09:17:03,052][__main__][INFO] - Model created with 527,953 parameters
[2025-09-29 09:17:03,957][__main__][INFO] - Starting training...
[2025-09-29 09:17:07,637][__main__][INFO] - Epoch 1/3: Train Loss: 0.4658, Val Loss: 0.4603
[2025-09-29 09:17:07,637][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3817125789472985), 'mae': 0.29274314641952515, 'accuracy': np.float64(0.8221204484914281), 'precision': np.float64(0.1568627450980392), 'recall': np.float64(0.0004860562610122122), 'f1': np.float64(0.0009691096305269534)}
[2025-09-29 09:17:07,637][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3792260776687289), 'mae': 0.28835445642471313, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 09:17:07,878][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:17:11,582][__main__][INFO] - Epoch 2/3: Train Loss: 0.4569, Val Loss: 0.4543
[2025-09-29 09:17:11,582][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3777609751664048), 'mae': 0.28851497173309326, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 09:17:11,582][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3764964089228689), 'mae': 0.2929719388484955, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 09:17:11,822][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:17:16,606][__main__][INFO] - Epoch 3/3: Train Loss: 0.4507, Val Loss: 0.4487
[2025-09-29 09:17:16,607][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3750895353558943), 'mae': 0.28653642535209656, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 09:17:16,607][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3742285780920188), 'mae': 0.28498387336730957, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 09:17:16,847][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:17:16,849][__main__][INFO] - Training completed!
[2025-09-29 09:17:16,849][__main__][INFO] - Best validation loss: 0.4487
[2025-09-29 09:17:25,131][__main__][INFO] - MLflow run completed
