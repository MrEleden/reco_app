[2025-09-28 21:31:54,824][__main__][INFO] - Configuration:
[2025-09-28 21:31:54,827][__main__][INFO] - model:
  name: collaborative
  type: CollaborativeFilteringModel
  embedding_dim: 50
  dropout: 0.2
  bias: true
  init_mean: 0.0
  init_std: 0.1
  description: Matrix factorization with user and movie embeddings
train:
  name: default
  batch_size: 256
  learning_rate: 0.01
  weight_decay: 0.0001
  epochs: 5
  patience: 5
  min_delta: 0.0001
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-28 21:31:56,427][__main__][INFO] - MLflow run started: 8ab026b938114a9a9f51457b442bd904
[2025-09-28 21:31:56,489][__main__][INFO] - Using device: cuda
[2025-09-28 21:31:56,573][__main__][INFO] - Loading data...
[2025-09-28 21:31:56,655][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-28 21:31:56,655][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-28 21:31:57,870][__main__][INFO] - Creating model: CollaborativeFilteringModel
[2025-09-28 21:31:58,036][__main__][INFO] - Model created with 527,953 parameters
[2025-09-28 21:31:59,828][__main__][INFO] - Starting training...
[2025-09-28 21:32:10,682][__main__][INFO] - Epoch 1/5: Train Loss: 0.4243, Val Loss: 0.3994
[2025-09-28 21:32:10,683][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3624325755324684), 'mae': 0.28287437558174133, 'accuracy': np.float64(0.8290297184885882), 'precision': np.float64(0.7548387096774194), 'recall': np.float64(0.05449905826599429), 'f1': np.float64(0.10165841864682104)}
[2025-09-28 21:32:10,683][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34993089777118935), 'mae': 0.26044851541519165, 'accuracy': np.float64(0.8320555787293413), 'precision': np.float64(0.7587822014051522), 'recall': np.float64(0.0787746170678337), 'f1': np.float64(0.14273127753303963)}
[2025-09-28 21:32:11,092][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 21:32:19,923][__main__][INFO] - Epoch 2/5: Train Loss: 0.3953, Val Loss: 0.3956
[2025-09-28 21:32:19,924][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34766027898275487), 'mae': 0.25873512029647827, 'accuracy': np.float64(0.8346628225913717), 'precision': np.float64(0.8), 'recall': np.float64(0.09137857707029588), 'f1': np.float64(0.16402202955450135)}
[2025-09-28 21:32:19,924][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3475641064208014), 'mae': 0.2608632445335388, 'accuracy': np.float64(0.8347165686175798), 'precision': np.float64(0.7572815533980582), 'recall': np.float64(0.1011427182105519), 'f1': np.float64(0.17845141917494814)}
[2025-09-28 21:32:20,356][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 21:32:30,330][__main__][INFO] - Epoch 3/5: Train Loss: 0.3932, Val Loss: 0.3947
[2025-09-28 21:32:30,331][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3465878969557641), 'mae': 0.2574918270111084, 'accuracy': np.float64(0.8353674099584077), 'precision': np.float64(0.7978369384359401), 'recall': np.float64(0.09710999048139822), 'f1': np.float64(0.17314532290970805)}
[2025-09-28 21:32:30,331][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34759510231183705), 'mae': 0.25837504863739014, 'accuracy': np.float64(0.8343425916603139), 'precision': np.float64(0.7747326203208557), 'recall': np.float64(0.09392981603047248), 'f1': np.float64(0.16754607878568847)}
[2025-09-28 21:32:30,780][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 21:32:38,703][__main__][INFO] - Epoch 4/5: Train Loss: 0.3924, Val Loss: 0.3941
[2025-09-28 21:32:38,703][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3461560767995455), 'mae': 0.2570486068725586, 'accuracy': np.float64(0.8358778763161584), 'precision': np.float64(0.8059848733969089), 'recall': np.float64(0.09927699131174433), 'f1': np.float64(0.17677924232315767)}
[2025-09-28 21:32:38,703][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34765949676369173), 'mae': 0.2558661699295044, 'accuracy': np.float64(0.8336377889331588), 'precision': np.float64(0.7599193006052455), 'recall': np.float64(0.09157954453359267), 'f1': np.float64(0.1634601475480978)}
[2025-09-28 21:32:38,976][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 21:32:45,730][__main__][INFO] - Epoch 5/5: Train Loss: 0.3913, Val Loss: 0.3944
[2025-09-28 21:32:45,730][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3456589837638256), 'mae': 0.2563289701938629, 'accuracy': np.float64(0.8358383331476003), 'precision': np.float64(0.8001941433425012), 'recall': np.float64(0.1001680944569334), 'f1': np.float64(0.17804816588070127)}
[2025-09-28 21:32:45,730][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34738205158438135), 'mae': 0.2590329945087433, 'accuracy': np.float64(0.8339110797865454), 'precision': np.float64(0.7564766839378239), 'recall': np.float64(0.09465921063295243), 'f1': np.float64(0.16826334365771087)}
[2025-09-28 21:32:46,067][__main__][INFO] - Training completed!
[2025-09-28 21:32:46,068][__main__][INFO] - Best validation loss: 0.3941
[2025-09-28 21:32:54,204][__main__][INFO] - MLflow run completed
