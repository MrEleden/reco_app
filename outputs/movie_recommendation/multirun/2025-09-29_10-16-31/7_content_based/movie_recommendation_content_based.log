[2025-09-29 10:48:52,880][__main__][INFO] - Configuration:
[2025-09-29 10:48:52,882][__main__][INFO] - model:
  name: content_based
  type: ContentBasedModel
  genre_embedding_dim: 32
  user_embedding_dim: 64
  hidden_dims:
  - 128
  - 64
  dropout: 0.2
  activation: relu
  description: Genre-based recommendations with user preferences
train:
  name: production
  batch_size: 128
  learning_rate: 0.02
  weight_decay: 0.0001
  epochs: 100
  patience: 5
  min_delta: 1.0e-05
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: true
  scheduler:
    type: cosine
    T_max: 100
    eta_min: 1.0e-06
  loss:
    type: bce
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@5
  - precision@10
  - precision@20
  - recall@5
  - recall@10
  - recall@20
  - ndcg@10
  - f1
  top_k:
  - 5
  - 10
  - 20
  - 50
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-29 10:48:52,972][__main__][INFO] - MLflow run started: f36438843c3f400e9521f0d67d9f1695
[2025-09-29 10:48:52,972][__main__][INFO] - Using device: cuda
[2025-09-29 10:48:53,012][__main__][INFO] - Loading data...
[2025-09-29 10:48:53,050][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 10:48:53,051][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 10:48:53,723][__main__][INFO] - Creating model: ContentBasedModel
[2025-09-29 10:48:53,832][__main__][INFO] - Model created with 4,865 parameters
[2025-09-29 10:48:53,887][__main__][INFO] - Starting training...
[2025-09-29 10:48:59,549][__main__][INFO] - Epoch 1/100: Train Loss: 0.4689, Val Loss: 0.4676
[2025-09-29 10:48:59,549][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38264155950420076), 'mae': 0.2932678163051605, 'accuracy': np.float64(0.8224439835069038), 'precision': np.float64(0.14285714285714285), 'recall': np.float64(6.075703262652652e-05), 'f1': np.float64(0.00012146240738491436)}
[2025-09-29 10:48:59,549][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3820837246169344), 'mae': 0.29362204670906067, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:48:59,792][__main__][INFO] - New best model saved: best_model_content_based.pth
[2025-09-29 10:49:06,356][__main__][INFO] - Epoch 2/100: Train Loss: 0.4677, Val Loss: 0.4678
[2025-09-29 10:49:06,356][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.382146664993276), 'mae': 0.2921667695045471, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:06,357][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.382165888208799), 'mae': 0.2865903377532959, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:12,780][__main__][INFO] - Epoch 3/100: Train Loss: 0.4677, Val Loss: 0.4677
[2025-09-29 10:49:12,782][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3821598639988393), 'mae': 0.2920314073562622, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:12,782][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3821352592815595), 'mae': 0.29633644223213196, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:19,525][__main__][INFO] - Epoch 4/100: Train Loss: 0.4678, Val Loss: 0.4679
[2025-09-29 10:49:19,525][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3821705281504375), 'mae': 0.2921135723590851, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:19,526][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3821844281426385), 'mae': 0.2860671579837799, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:26,229][__main__][INFO] - Epoch 5/100: Train Loss: 0.4677, Val Loss: 0.4676
[2025-09-29 10:49:26,229][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38213397246194414), 'mae': 0.29208874702453613, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:26,229][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38210412093009166), 'mae': 0.2889263927936554, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:32,827][__main__][INFO] - Epoch 6/100: Train Loss: 0.4679, Val Loss: 0.4678
[2025-09-29 10:49:32,827][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3822035130025944), 'mae': 0.29209020733833313, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:32,827][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.382150778764737), 'mae': 0.28705745935440063, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:49:33,079][__main__][INFO] - Early stopping after 6 epochs
[2025-09-29 10:49:33,079][__main__][INFO] - Training completed!
[2025-09-29 10:49:33,079][__main__][INFO] - Best validation loss: 0.4676
[2025-09-29 10:49:36,152][__main__][INFO] - MLflow run completed
