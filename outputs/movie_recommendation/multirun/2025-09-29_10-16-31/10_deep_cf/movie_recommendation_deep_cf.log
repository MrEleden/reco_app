[2025-09-29 10:51:17,758][__main__][INFO] - Configuration:
[2025-09-29 10:51:17,761][__main__][INFO] - model:
  name: deep_cf
  type: DeepCollaborativeFiltering
  embedding_dim: 64
  hidden_dims:
  - 256
  - 128
  - 64
  dropout: 0.1
  batch_norm: true
  activation: relu
  description: Deep neural network for collaborative filtering
train:
  name: production
  batch_size: 512
  learning_rate: 0.0005
  weight_decay: 0.01
  epochs: 100
  patience: 5
  min_delta: 1.0e-05
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: true
  scheduler:
    type: cosine
    T_max: 100
    eta_min: 1.0e-06
  loss:
    type: bce
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@5
  - precision@10
  - precision@20
  - recall@5
  - recall@10
  - recall@20
  - ndcg@10
  - f1
  top_k:
  - 5
  - 10
  - 20
  - 50
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-29 10:51:17,849][__main__][INFO] - MLflow run started: b0ec390d83d746c6a2bfbd66b1acca74
[2025-09-29 10:51:17,850][__main__][INFO] - Using device: cuda
[2025-09-29 10:51:17,870][__main__][INFO] - Loading data...
[2025-09-29 10:51:17,907][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 10:51:17,907][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 10:51:18,587][__main__][INFO] - Creating model: DeepCollaborativeFiltering
[2025-09-29 10:51:18,593][__main__][INFO] - Model created with 736,769 parameters
[2025-09-29 10:51:18,645][__main__][INFO] - Starting training...
[2025-09-29 10:51:22,290][__main__][INFO] - Epoch 1/100: Train Loss: 0.4832, Val Loss: 0.4682
[2025-09-29 10:51:22,290][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.39086220215090056), 'mae': 0.3155152499675751, 'accuracy': np.float64(0.8219910344852378), 'precision': np.float64(0.16587677725118483), 'recall': np.float64(0.0007088320473094761), 'f1': np.float64(0.001411631846414455)}
[2025-09-29 10:51:22,290][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38232088635625666), 'mae': 0.3008040189743042, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:22,534][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 10:51:26,404][__main__][INFO] - Epoch 2/100: Train Loss: 0.4690, Val Loss: 0.4676
[2025-09-29 10:51:26,405][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38265454673154364), 'mae': 0.2984004318714142, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:26,405][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3820906275063705), 'mae': 0.2941843867301941, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:26,656][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 10:51:31,016][__main__][INFO] - Epoch 3/100: Train Loss: 0.4686, Val Loss: 0.4681
[2025-09-29 10:51:31,016][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38251238366569), 'mae': 0.2982425391674042, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:31,016][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3822901139327417), 'mae': 0.30023181438446045, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:35,355][__main__][INFO] - Epoch 4/100: Train Loss: 0.4684, Val Loss: 0.4679
[2025-09-29 10:51:35,355][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3824659842281981), 'mae': 0.2981518805027008, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:35,355][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3821952670564346), 'mae': 0.2981444001197815, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:39,606][__main__][INFO] - Epoch 5/100: Train Loss: 0.4684, Val Loss: 0.4677
[2025-09-29 10:51:39,606][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38242702149463315), 'mae': 0.29817232489585876, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:39,608][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38214469582633553), 'mae': 0.2966669499874115, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:43,816][__main__][INFO] - Epoch 6/100: Train Loss: 0.4683, Val Loss: 0.4680
[2025-09-29 10:51:43,816][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38238014406533216), 'mae': 0.2982253432273865, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:43,817][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3822386781139738), 'mae': 0.2991754114627838, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:48,336][__main__][INFO] - Epoch 7/100: Train Loss: 0.4682, Val Loss: 0.4682
[2025-09-29 10:51:48,336][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38235329314038746), 'mae': 0.2982015013694763, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:48,336][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38232084738071936), 'mae': 0.30080288648605347, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:48,583][__main__][INFO] - Early stopping after 7 epochs
[2025-09-29 10:51:48,583][__main__][INFO] - Training completed!
[2025-09-29 10:51:48,583][__main__][INFO] - Best validation loss: 0.4676
[2025-09-29 10:51:51,790][__main__][INFO] - MLflow run completed
