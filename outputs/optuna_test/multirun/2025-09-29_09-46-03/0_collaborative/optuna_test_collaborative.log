[2025-09-29 09:46:03,918][__main__][INFO] - Configuration:
[2025-09-29 09:46:03,920][__main__][INFO] - model:
  name: collaborative
  type: CollaborativeFilteringModel
  embedding_dim: 50
  dropout: 0.2
  bias: true
  init_mean: 0.0
  init_std: 0.1
  description: Matrix factorization with user and movie embeddings
train:
  name: default
  batch_size: 256
  learning_rate: 0.005
  weight_decay: 0.0001
  epochs: 5
  patience: 3
  min_delta: 0.0001
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: optuna_test
  tags:
  - optuna
  - test
  notes: Testing Optuna integration
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: false
  log_artifacts: false

[2025-09-29 09:46:04,389][__main__][INFO] - MLflow run started: e72f0c1a971542cc86587c3ef0727cb7
[2025-09-29 09:46:04,401][__main__][INFO] - Using device: cuda
[2025-09-29 09:46:04,461][__main__][INFO] - Loading data...
[2025-09-29 09:46:04,501][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 09:46:04,501][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 09:46:05,146][__main__][INFO] - Creating model: CollaborativeFilteringModel
[2025-09-29 09:46:05,220][__main__][INFO] - Model created with 527,953 parameters
[2025-09-29 09:46:06,228][__main__][INFO] - Starting training...
[2025-09-29 09:46:10,228][__main__][INFO] - Epoch 1/5: Train Loss: 0.4398, Val Loss: 0.4012
[2025-09-29 09:46:10,228][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.37023008129546475), 'mae': 0.300629198551178, 'accuracy': np.float64(0.8280519237751504), 'precision': np.float64(0.7523685070238484), 'recall': np.float64(0.04664114871296353), 'f1': np.float64(0.08783706472405509)}
[2025-09-29 09:46:10,228][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.35069832023308606), 'mae': 0.26328709721565247, 'accuracy': np.float64(0.8309624153157947), 'precision': np.float64(0.7646528403967539), 'recall': np.float64(0.06872518032255451), 'f1': np.float64(0.1261154074955384)}
[2025-09-29 09:46:10,471][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:46:14,474][__main__][INFO] - Epoch 2/5: Train Loss: 0.3957, Val Loss: 0.3947
[2025-09-29 09:46:14,474][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3478407745144961), 'mae': 0.2597511112689972, 'accuracy': np.float64(0.8341990890691897), 'precision': np.float64(0.7971517253971152), 'recall': np.float64(0.08842173481580493), 'f1': np.float64(0.15918620337623507)}
[2025-09-29 09:46:14,474][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34733241783048585), 'mae': 0.25978049635887146, 'accuracy': np.float64(0.8338247774117917), 'precision': np.float64(0.7634048257372654), 'recall': np.float64(0.09230893913607262), 'f1': np.float64(0.16470247993637482)}
[2025-09-29 09:46:14,734][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:46:19,261][__main__][INFO] - Epoch 3/5: Train Loss: 0.3919, Val Loss: 0.3935
[2025-09-29 09:46:19,261][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3459511099139406), 'mae': 0.2573927342891693, 'accuracy': np.float64(0.8355004187981033), 'precision': np.float64(0.8020711541673626), 'recall': np.float64(0.09725175689086012), 'f1': np.float64(0.17347012499096887)}
[2025-09-29 09:46:19,261][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34713858736292424), 'mae': 0.25736939907073975, 'accuracy': np.float64(0.8339973821612992), 'precision': np.float64(0.7717983651226158), 'recall': np.float64(0.09182267606775266), 'f1': np.float64(0.16411964945317592)}
[2025-09-29 09:46:19,526][__main__][INFO] - New best model saved: best_model_collaborative.pth
