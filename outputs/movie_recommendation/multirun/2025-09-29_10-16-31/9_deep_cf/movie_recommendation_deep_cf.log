[2025-09-29 10:50:25,243][__main__][INFO] - Configuration:
[2025-09-29 10:50:25,244][__main__][INFO] - model:
  name: deep_cf
  type: DeepCollaborativeFiltering
  embedding_dim: 64
  hidden_dims:
  - 256
  - 128
  - 64
  dropout: 0.5
  batch_norm: true
  activation: relu
  description: Deep neural network for collaborative filtering
train:
  name: production
  batch_size: 1024
  learning_rate: 0.05
  weight_decay: 0.001
  epochs: 100
  patience: 8
  min_delta: 1.0e-05
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: true
  scheduler:
    type: cosine
    T_max: 100
    eta_min: 1.0e-06
  loss:
    type: bce
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@5
  - precision@10
  - precision@20
  - recall@5
  - recall@10
  - recall@20
  - ndcg@10
  - f1
  top_k:
  - 5
  - 10
  - 20
  - 50
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-29 10:50:25,338][__main__][INFO] - MLflow run started: e575e87648a74e949a0d6e6c1c5979d7
[2025-09-29 10:50:25,338][__main__][INFO] - Using device: cuda
[2025-09-29 10:50:25,369][__main__][INFO] - Loading data...
[2025-09-29 10:50:25,406][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 10:50:25,406][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 10:50:26,085][__main__][INFO] - Creating model: DeepCollaborativeFiltering
[2025-09-29 10:50:26,091][__main__][INFO] - Model created with 736,769 parameters
[2025-09-29 10:50:26,139][__main__][INFO] - Starting training...
[2025-09-29 10:50:29,593][__main__][INFO] - Epoch 1/100: Train Loss: 0.4722, Val Loss: 0.4676
[2025-09-29 10:50:29,594][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38421040864494355), 'mae': 0.2967163324356079, 'accuracy': np.float64(0.8213942921233603), 'precision': np.float64(0.19483101391650098), 'recall': np.float64(0.001984729732466533), 'f1': np.float64(0.003929430633520449)}
[2025-09-29 10:50:29,594][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38210164457155443), 'mae': 0.2948673367500305, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:29,839][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 10:50:33,235][__main__][INFO] - Epoch 2/100: Train Loss: 0.4678, Val Loss: 0.4676
[2025-09-29 10:50:33,235][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.382171639388603), 'mae': 0.2932635545730591, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:33,235][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38209948018205153), 'mae': 0.2891799509525299, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:37,340][__main__][INFO] - Epoch 3/100: Train Loss: 0.4677, Val Loss: 0.4676
[2025-09-29 10:50:37,340][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3821326856379955), 'mae': 0.2929902672767639, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:37,340][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38209620432597), 'mae': 0.2945541739463806, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:37,590][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 10:50:41,546][__main__][INFO] - Epoch 4/100: Train Loss: 0.4678, Val Loss: 0.4676
[2025-09-29 10:50:41,546][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3821594545830657), 'mae': 0.2929393947124481, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:41,546][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3820753005829003), 'mae': 0.29222509264945984, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:41,808][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 10:50:45,653][__main__][INFO] - Epoch 5/100: Train Loss: 0.4677, Val Loss: 0.4676
[2025-09-29 10:50:45,654][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3821436040066295), 'mae': 0.2929667532444, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:45,654][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3820882485585579), 'mae': 0.2899200916290283, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:49,831][__main__][INFO] - Epoch 6/100: Train Loss: 0.4677, Val Loss: 0.4676
[2025-09-29 10:50:49,832][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38215017437454873), 'mae': 0.2930538058280945, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:49,832][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38207916162155453), 'mae': 0.2930983006954193, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:54,139][__main__][INFO] - Epoch 7/100: Train Loss: 0.4677, Val Loss: 0.4681
[2025-09-29 10:50:54,139][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.382137423468413), 'mae': 0.2928429841995239, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:54,139][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38227341120664604), 'mae': 0.2999044954776764, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:58,273][__main__][INFO] - Epoch 8/100: Train Loss: 0.4677, Val Loss: 0.4677
[2025-09-29 10:50:58,273][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38214420840720936), 'mae': 0.29299941658973694, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:50:58,273][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38211527409403695), 'mae': 0.29553523659706116, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:02,375][__main__][INFO] - Epoch 9/100: Train Loss: 0.6665, Val Loss: 0.4676
[2025-09-29 10:51:02,375][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3875604197866627), 'mae': 0.2933633029460907, 'accuracy': np.float64(0.8183710371454146), 'precision': np.float64(0.16354044548651817), 'recall': np.float64(0.005650404034266966), 'f1': np.float64(0.010923399173893468)}
[2025-09-29 10:51:02,375][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3821084301456616), 'mae': 0.29521679878234863, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:06,463][__main__][INFO] - Epoch 10/100: Train Loss: 0.4678, Val Loss: 0.4676
[2025-09-29 10:51:06,463][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38218805414441936), 'mae': 0.2930237650871277, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:06,463][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38209442989219927), 'mae': 0.29444360733032227, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:10,411][__main__][INFO] - Epoch 11/100: Train Loss: 0.4677, Val Loss: 0.4676
[2025-09-29 10:51:10,411][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3821579728842191), 'mae': 0.2929699420928955, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:10,411][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38207894712043067), 'mae': 0.2908583879470825, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:14,342][__main__][INFO] - Epoch 12/100: Train Loss: 0.4677, Val Loss: 0.4676
[2025-09-29 10:51:14,342][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38215686160631407), 'mae': 0.292989581823349, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:14,344][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3820815016259924), 'mae': 0.2933906316757202, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:51:14,596][__main__][INFO] - Early stopping after 12 epochs
[2025-09-29 10:51:14,598][__main__][INFO] - Training completed!
[2025-09-29 10:51:14,598][__main__][INFO] - Best validation loss: 0.4676
[2025-09-29 10:51:17,691][__main__][INFO] - MLflow run completed
