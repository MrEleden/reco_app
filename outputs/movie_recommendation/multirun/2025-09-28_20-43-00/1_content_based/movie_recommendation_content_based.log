[2025-09-28 20:47:01,196][__main__][INFO] - Configuration:
[2025-09-28 20:47:01,198][__main__][INFO] - model:
  name: content_based
  type: ContentBasedModel
  genre_embedding_dim: 32
  user_embedding_dim: 64
  hidden_dims:
  - 128
  - 64
  dropout: 0.3
  activation: relu
  description: Genre-based recommendations with user preferences
train:
  name: default
  batch_size: 256
  learning_rate: 0.01
  weight_decay: 0.0001
  epochs: 20
  patience: 5
  min_delta: 0.0001
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto

[2025-09-28 20:47:01,200][__main__][INFO] - Using device: cuda
[2025-09-28 20:47:01,200][__main__][INFO] - Loading data...
[2025-09-28 20:47:01,250][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-28 20:47:01,250][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-28 20:47:02,326][__main__][INFO] - Creating model: ContentBasedModel
[2025-09-28 20:47:02,510][__main__][INFO] - Model created with 4,865 parameters
[2025-09-28 20:47:02,510][__main__][INFO] - Starting training...
[2025-09-28 20:47:11,186][__main__][INFO] - Epoch 1/20: Train Loss: 0.4706, Val Loss: 0.4667
[2025-09-28 20:47:11,186][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3833850743612198), 'mae': 0.29514461755752563, 'accuracy': np.float64(0.8223541126692717), 'precision': np.float64(0.1774193548387097), 'recall': np.float64(0.0002227757862972639), 'f1': np.float64(0.00044499281943405003)}
[2025-09-28 20:47:11,186][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3817495067758128), 'mae': 0.2931189239025116, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:11,193][__main__][INFO] - New best model saved: best_model_content_based.pth
[2025-09-28 20:47:21,010][__main__][INFO] - Epoch 2/20: Train Loss: 0.4671, Val Loss: 0.4672
[2025-09-28 20:47:21,010][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38190826355428537), 'mae': 0.2922935485839844, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:21,011][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38195159019182134), 'mae': 0.2839917540550232, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:30,291][__main__][INFO] - Epoch 3/20: Train Loss: 0.4670, Val Loss: 0.4674
[2025-09-28 20:47:30,291][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38188623745830597), 'mae': 0.29163098335266113, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:30,291][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38201490339945676), 'mae': 0.2988360524177551, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:39,493][__main__][INFO] - Epoch 4/20: Train Loss: 0.4671, Val Loss: 0.4670
[2025-09-28 20:47:39,494][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38192059293120606), 'mae': 0.291878879070282, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:39,494][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3818654587985017), 'mae': 0.2903154790401459, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:50,497][__main__][INFO] - Epoch 5/20: Train Loss: 0.4671, Val Loss: 0.4669
[2025-09-28 20:47:50,497][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38191515010660537), 'mae': 0.29175546765327454, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:50,497][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38183014223818074), 'mae': 0.2923527956008911, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:59,990][__main__][INFO] - Epoch 6/20: Train Loss: 0.4667, Val Loss: 0.4666
[2025-09-28 20:47:59,990][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38178120096379176), 'mae': 0.2915692925453186, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:59,990][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38173071150399557), 'mae': 0.2882607579231262, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-28 20:47:59,990][__main__][INFO] - Early stopping after 6 epochs
[2025-09-28 20:47:59,990][__main__][INFO] - Training completed!
[2025-09-28 20:47:59,992][__main__][INFO] - Best validation loss: 0.4667
