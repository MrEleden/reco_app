[2025-09-28 18:33:53,713][__main__][INFO] - Configuration:
[2025-09-28 18:33:53,715][__main__][INFO] - model:
  name: collaborative
  type: CollaborativeFilteringModel
  embedding_dim: 50
  dropout: 0.2
  bias: true
  init_mean: 0.0
  init_std: 0.1
  description: Matrix factorization with user and movie embeddings
train:
  name: default
  batch_size: 256
  learning_rate: 0.01
  weight_decay: 0.0001
  epochs: 20
  patience: 5
  min_delta: 0.0001
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: false
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto

[2025-09-28 18:33:53,717][__main__][INFO] - Using device: cpu
[2025-09-28 18:33:53,717][__main__][INFO] - Loading data...
[2025-09-28 18:33:53,757][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-28 18:33:53,757][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-28 18:33:54,387][__main__][INFO] - Creating model: CollaborativeFilteringModel
[2025-09-28 18:33:54,391][__main__][INFO] - Model created with 527,953 parameters
[2025-09-28 18:33:55,236][__main__][INFO] - Starting training...
[2025-09-28 18:33:59,991][__main__][INFO] - Epoch 1/20: Train Loss: 0.4246, Val Loss: 0.3999
[2025-09-28 18:33:59,991][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3626254941495772), 'mae': 0.2830825448036194, 'accuracy': np.float64(0.8289614166519877), 'precision': np.float64(0.7525280898876404), 'recall': np.float64(0.05425603013548818), 'f1': np.float64(0.10121465137805316)}
[2025-09-28 18:33:59,991][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3501454936481504), 'mae': 0.26123490929603577, 'accuracy': np.float64(0.8325302417904866), 'precision': np.float64(0.7779552715654952), 'recall': np.float64(0.07893670475727368), 'f1': np.float64(0.14333014494886323)}
[2025-09-28 18:33:59,998][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 18:34:04,868][__main__][INFO] - Epoch 2/20: Train Loss: 0.3952, Val Loss: 0.3959
[2025-09-28 18:34:04,868][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3475991855893565), 'mae': 0.258831650018692, 'accuracy': np.float64(0.8343572617434224), 'precision': np.float64(0.7962996227770792), 'recall': np.float64(0.08977864187779735), 'f1': np.float64(0.16136429819452533)}
[2025-09-28 18:34:04,868][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34854241275688497), 'mae': 0.2561519742012024, 'accuracy': np.float64(0.8325733929778635), 'precision': np.float64(0.7594654788418709), 'recall': np.float64(0.08290785314855337), 'f1': np.float64(0.14949583516001752)}
[2025-09-28 18:34:04,874][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 18:34:09,815][__main__][INFO] - Epoch 3/20: Train Loss: 0.3930, Val Loss: 0.3944
[2025-09-28 18:34:09,816][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34649155575989105), 'mae': 0.25733450055122375, 'accuracy': np.float64(0.835255970119744), 'precision': np.float64(0.7954053604128517), 'recall': np.float64(0.0967657006298479), 'f1': np.float64(0.17254080600895566)}
[2025-09-28 18:34:09,816][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34751222606118626), 'mae': 0.2576139569282532, 'accuracy': np.float64(0.8335658702875307), 'precision': np.float64(0.7612244897959184), 'recall': np.float64(0.09068806224167275), 'f1': np.float64(0.16206821638062133)}
[2025-09-28 18:34:09,821][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 18:34:14,539][__main__][INFO] - Epoch 4/20: Train Loss: 0.3918, Val Loss: 0.3948
[2025-09-28 18:34:14,539][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3458923963970197), 'mae': 0.25663959980010986, 'accuracy': np.float64(0.8356945398073888), 'precision': np.float64(0.7991850040749796), 'recall': np.float64(0.09929724365595317), 'f1': np.float64(0.17664649084882547)}
[2025-09-28 18:34:14,539][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34751681414069235), 'mae': 0.2592204809188843, 'accuracy': np.float64(0.8339110797865454), 'precision': np.float64(0.7647058823529411), 'recall': np.float64(0.09271415835967259), 'f1': np.float64(0.16537766534152512)}
[2025-09-28 18:34:19,378][__main__][INFO] - Epoch 5/20: Train Loss: 0.3909, Val Loss: 0.3943
[2025-09-28 18:34:19,378][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34547370367065755), 'mae': 0.25616008043289185, 'accuracy': np.float64(0.8360612128249281), 'precision': np.float64(0.7982608695652174), 'recall': np.float64(0.10225408591044413), 'f1': np.float64(0.1812861297619475)}
[2025-09-28 18:34:19,378][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3478074334419066), 'mae': 0.256583034992218, 'accuracy': np.float64(0.8327891489147476), 'precision': np.float64(0.7672155688622755), 'recall': np.float64(0.08306994083799335), 'f1': np.float64(0.14990859232175502)}
[2025-09-28 18:34:19,384][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 18:34:24,360][__main__][INFO] - Epoch 6/20: Train Loss: 0.3911, Val Loss: 0.3926
[2025-09-28 18:34:24,361][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34558966763030086), 'mae': 0.2562643885612488, 'accuracy': np.float64(0.8357808158115156), 'precision': np.float64(0.7964062249318146), 'recall': np.float64(0.10053263665269255), 'f1': np.float64(0.1785290415392915)}
[2025-09-28 18:34:24,361][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3462908861485553), 'mae': 0.25891751050949097, 'accuracy': np.float64(0.8356802784689958), 'precision': np.float64(0.7692760447321955), 'recall': np.float64(0.10592430504903153), 'f1': np.float64(0.18620886166120532)}
[2025-09-28 18:34:24,366][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 18:34:29,247][__main__][INFO] - Epoch 7/20: Train Loss: 0.3899, Val Loss: 0.3921
[2025-09-28 18:34:29,247][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34495635114162426), 'mae': 0.25563910603523254, 'accuracy': np.float64(0.8369203780326914), 'precision': np.float64(0.8044930176077717), 'recall': np.float64(0.10733742430686352), 'f1': np.float64(0.1894040918431162)}
[2025-09-28 18:34:29,247][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3467051322088428), 'mae': 0.25496140122413635, 'accuracy': np.float64(0.8342131380981833), 'precision': np.float64(0.7763426240652618), 'recall': np.float64(0.09255207067023259), 'f1': np.float64(0.16538740043446776)}
[2025-09-28 18:34:29,253][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-28 18:34:34,393][__main__][INFO] - Epoch 8/20: Train Loss: 0.3902, Val Loss: 0.3929
[2025-09-28 18:34:34,393][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34511290559989055), 'mae': 0.25567522644996643, 'accuracy': np.float64(0.8364171013419514), 'precision': np.float64(0.7978461538461539), 'recall': np.float64(0.10502865706705551), 'f1': np.float64(0.18562199115915315)}
[2025-09-28 18:34:34,393][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34705770595240815), 'mae': 0.2550693154335022, 'accuracy': np.float64(0.8342419055564345), 'precision': np.float64(0.7733065057008719), 'recall': np.float64(0.09344355296215252), 'f1': np.float64(0.16673897324656542)}
[2025-09-28 18:34:41,709][__main__][INFO] - Epoch 9/20: Train Loss: 0.3904, Val Loss: 0.3921
[2025-09-28 18:34:41,710][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3452157502115265), 'mae': 0.25582101941108704, 'accuracy': np.float64(0.8362409545001923), 'precision': np.float64(0.7967706877814004), 'recall': np.float64(0.10393503047977803), 'f1': np.float64(0.18388333512487012)}
[2025-09-28 18:34:41,710][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.34589495966760636), 'mae': 0.25942251086235046, 'accuracy': np.float64(0.8355508249068654), 'precision': np.float64(0.7600459242250287), 'recall': np.float64(0.10730205040927142), 'f1': np.float64(0.18805482565158724)}
[2025-09-28 18:34:47,637][__main__][INFO] - Epoch 10/20: Train Loss: 0.3896, Val Loss: 0.3927
[2025-09-28 18:34:47,637][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34481472152470044), 'mae': 0.25532951951026917, 'accuracy': np.float64(0.8363811530068985), 'precision': np.float64(0.7931976920740965), 'recall': np.float64(0.10579824614699151), 'f1': np.float64(0.18669478047995997)}
[2025-09-28 18:34:47,637][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3462973514604038), 'mae': 0.2586959898471832, 'accuracy': np.float64(0.8355508249068654), 'precision': np.float64(0.7594501718213058), 'recall': np.float64(0.1074641380987114), 'f1': np.float64(0.18828541001064963)}
[2025-09-28 18:34:53,022][__main__][INFO] - Epoch 11/20: Train Loss: 0.3895, Val Loss: 0.3928
[2025-09-28 18:34:53,022][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3447654205121113), 'mae': 0.255336195230484, 'accuracy': np.float64(0.8363452046718456), 'precision': np.float64(0.793418647166362), 'recall': np.float64(0.10547420863965004), 'f1': np.float64(0.18619617096583901)}
[2025-09-28 18:34:53,022][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3460218393607961), 'mae': 0.2609504461288452, 'accuracy': np.float64(0.8367015232369144), 'precision': np.float64(0.7735849056603774), 'recall': np.float64(0.11297511953967096), 'f1': np.float64(0.1971572024609292)}
[2025-09-28 18:34:58,565][__main__][INFO] - Epoch 12/20: Train Loss: 0.3898, Val Loss: 0.3925
[2025-09-28 18:34:58,566][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3448993800810532), 'mae': 0.25553765892982483, 'accuracy': np.float64(0.8366256016852579), 'precision': np.float64(0.7970072551390568), 'recall': np.float64(0.10679061101322478), 'f1': np.float64(0.1883449716928902)}
[2025-09-28 18:34:58,566][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3464135881471762), 'mae': 0.2577171325683594, 'accuracy': np.float64(0.8352919177826044), 'precision': np.float64(0.769090909090909), 'recall': np.float64(0.10284463894967177), 'f1': np.float64(0.18142826506540852)}
[2025-09-28 18:34:58,566][__main__][INFO] - Early stopping after 12 epochs
[2025-09-28 18:34:58,566][__main__][INFO] - Training completed!
[2025-09-28 18:34:58,566][__main__][INFO] - Best validation loss: 0.3921
