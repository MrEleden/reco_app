[2025-09-29 09:17:58,601][__main__][INFO] - Configuration:
[2025-09-29 09:17:58,602][__main__][INFO] - model:
  name: collaborative
  type: CollaborativeFilteringModel
  embedding_dim: 50
  dropout: 0.2
  bias: true
  init_mean: 0.0
  init_std: 0.1
  description: Matrix factorization with user and movie embeddings
train:
  name: production
  batch_size: 256
  learning_rate: 0.005
  weight_decay: 5.0e-05
  epochs: 100
  patience: 10
  min_delta: 1.0e-05
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: true
  scheduler:
    type: cosine
    T_max: 100
    eta_min: 1.0e-06
  loss:
    type: bce
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@5
  - precision@10
  - precision@20
  - recall@5
  - recall@10
  - recall@20
  - ndcg@10
  - f1
  top_k:
  - 5
  - 10
  - 20
  - 50
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-29 09:17:58,970][__main__][INFO] - MLflow run started: bfec101aae14446cba0a76c69fe1111b
[2025-09-29 09:17:58,983][__main__][INFO] - Using device: cuda
[2025-09-29 09:17:59,023][__main__][INFO] - Loading data...
[2025-09-29 09:17:59,060][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 09:17:59,060][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 09:17:59,734][__main__][INFO] - Creating model: CollaborativeFilteringModel
[2025-09-29 09:17:59,831][__main__][INFO] - Model created with 527,953 parameters
[2025-09-29 09:18:00,713][__main__][INFO] - Starting training...
[2025-09-29 09:18:04,391][__main__][INFO] - Epoch 1/100: Train Loss: 0.4236, Val Loss: 0.3788
[2025-09-29 09:18:04,391][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.36239402882754557), 'mae': 0.2881663143634796, 'accuracy': np.float64(0.8362409545001923), 'precision': np.float64(0.7153802816901409), 'recall': np.float64(0.12858213338193897), 'f1': np.float64(0.21798393188216714)}
[2025-09-29 09:18:04,391][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33978785131843486), 'mae': 0.24773119390010834, 'accuracy': np.float64(0.8407433511212117), 'precision': np.float64(0.7226713532513181), 'recall': np.float64(0.16662614474430668), 'f1': np.float64(0.2708113804004215)}
[2025-09-29 09:18:04,617][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:18:08,334][__main__][INFO] - Epoch 2/100: Train Loss: 0.3721, Val Loss: 0.3701
[2025-09-29 09:18:08,335][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33647554026834614), 'mae': 0.24204494059085846, 'accuracy': np.float64(0.8447247615726677), 'precision': np.float64(0.7345777373093558), 'recall': np.float64(0.1960629442858011), 'f1': np.float64(0.30951467485133327)}
[2025-09-29 09:18:08,335][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3353212381737065), 'mae': 0.24229761958122253, 'accuracy': np.float64(0.8450728535880212), 'precision': np.float64(0.7315416420555227), 'recall': np.float64(0.20074560337142394), 'f1': np.float64(0.315039745627981)}
[2025-09-29 09:18:08,569][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:18:13,390][__main__][INFO] - Epoch 3/100: Train Loss: 0.3656, Val Loss: 0.3665
[2025-09-29 09:18:13,390][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3331964132118197), 'mae': 0.23852455615997314, 'accuracy': np.float64(0.8467666270036703), 'precision': np.float64(0.7442297952391289), 'recall': np.float64(0.20831561253215058), 'f1': np.float64(0.3255166302731099)}
[2025-09-29 09:18:13,390][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3338309710930562), 'mae': 0.23945076763629913, 'accuracy': np.float64(0.8446988766307553), 'precision': np.float64(0.7268981753972925), 'recall': np.float64(0.20017829645838398), 'f1': np.float64(0.31390989388066337)}
[2025-09-29 09:18:13,632][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:18:18,527][__main__][INFO] - Epoch 4/100: Train Loss: 0.3616, Val Loss: 0.3656
[2025-09-29 09:18:18,527][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3311037910526662), 'mae': 0.23640044033527374, 'accuracy': np.float64(0.8484274400831125), 'precision': np.float64(0.75134155690292), 'recall': np.float64(0.21834052291552747), 'f1': np.float64(0.3383548316228855)}
[2025-09-29 09:18:18,527][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3336526104102509), 'mae': 0.23812657594680786, 'accuracy': np.float64(0.8445118881521223), 'precision': np.float64(0.7226915234488785), 'recall': np.float64(0.2010697787503039), 'f1': np.float64(0.3146081663707837)}
[2025-09-29 09:18:18,766][__main__][INFO] - New best model saved: best_model_collaborative.pth
[2025-09-29 09:18:23,548][__main__][INFO] - Epoch 5/100: Train Loss: 0.3590, Val Loss: 0.3646
[2025-09-29 09:18:23,548][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3297836525080463), 'mae': 0.23495396971702576, 'accuracy': np.float64(0.8487150267635355), 'precision': np.float64(0.7511536607204353), 'recall': np.float64(0.22087206594163275), 'f1': np.float64(0.3413672217353199)}
[2025-09-29 09:18:23,549][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3326235817044314), 'mae': 0.2401406317949295, 'accuracy': np.float64(0.8461372495433166), 'precision': np.float64(0.7249315068493151), 'recall': np.float64(0.21444201312910285), 'f1': np.float64(0.3309775470636062)}
