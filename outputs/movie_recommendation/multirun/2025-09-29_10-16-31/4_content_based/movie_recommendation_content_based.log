[2025-09-29 10:30:16,732][__main__][INFO] - Configuration:
[2025-09-29 10:30:16,734][__main__][INFO] - model:
  name: content_based
  type: ContentBasedModel
  genre_embedding_dim: 32
  user_embedding_dim: 64
  hidden_dims:
  - 128
  - 64
  dropout: 0.5
  activation: relu
  description: Genre-based recommendations with user preferences
train:
  name: production
  batch_size: 1024
  learning_rate: 0.005
  weight_decay: 0.0001
  epochs: 100
  patience: 8
  min_delta: 1.0e-05
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: true
  scheduler:
    type: cosine
    T_max: 100
    eta_min: 1.0e-06
  loss:
    type: bce
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@5
  - precision@10
  - precision@20
  - recall@5
  - recall@10
  - recall@20
  - ndcg@10
  - f1
  top_k:
  - 5
  - 10
  - 20
  - 50
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-29 10:30:16,831][__main__][INFO] - MLflow run started: b83e9c9e1c774f82b4ca2e8811f6052f
[2025-09-29 10:30:16,831][__main__][INFO] - Using device: cuda
[2025-09-29 10:30:16,865][__main__][INFO] - Loading data...
[2025-09-29 10:30:16,901][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 10:30:16,901][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 10:30:17,568][__main__][INFO] - Creating model: ContentBasedModel
[2025-09-29 10:30:17,677][__main__][INFO] - Model created with 4,865 parameters
[2025-09-29 10:30:17,725][__main__][INFO] - Starting training...
[2025-09-29 10:30:20,955][__main__][INFO] - Epoch 1/100: Train Loss: 0.4831, Val Loss: 0.4674
[2025-09-29 10:30:20,955][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38907592704308075), 'mae': 0.30668655037879944, 'accuracy': np.float64(0.8215129216290348), 'precision': np.float64(0.1625615763546798), 'recall': np.float64(0.0013366547177835835), 'f1': np.float64(0.0026515075427354724)}
[2025-09-29 10:30:20,955][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3820175753527314), 'mae': 0.2982665002346039, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:21,189][__main__][INFO] - New best model saved: best_model_content_based.pth
[2025-09-29 10:30:24,601][__main__][INFO] - Epoch 2/100: Train Loss: 0.4716, Val Loss: 0.4667
[2025-09-29 10:30:24,601][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38376225190998164), 'mae': 0.29749149084091187, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:24,601][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3817374646365218), 'mae': 0.2933931052684784, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:24,850][__main__][INFO] - New best model saved: best_model_content_based.pth
[2025-09-29 10:30:28,808][__main__][INFO] - Epoch 3/100: Train Loss: 0.4687, Val Loss: 0.4673
[2025-09-29 10:30:28,809][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38252518050516937), 'mae': 0.2948642671108246, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:28,809][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3819585149754942), 'mae': 0.3015229105949402, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:32,994][__main__][INFO] - Epoch 4/100: Train Loss: 0.4673, Val Loss: 0.4660
[2025-09-29 10:30:32,994][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3819754265251103), 'mae': 0.29375341534614563, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:32,994][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38148841751084794), 'mae': 0.2902095317840576, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:33,242][__main__][INFO] - New best model saved: best_model_content_based.pth
[2025-09-29 10:30:37,266][__main__][INFO] - Epoch 5/100: Train Loss: 0.4666, Val Loss: 0.4661
[2025-09-29 10:30:37,266][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3816971782845868), 'mae': 0.2925806939601898, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:37,266][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.381470585936532), 'mae': 0.2891389727592468, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:41,180][__main__][INFO] - Epoch 6/100: Train Loss: 0.4662, Val Loss: 0.4661
[2025-09-29 10:30:41,181][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3815479802548721), 'mae': 0.29180678725242615, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:41,181][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3815115406770607), 'mae': 0.290324866771698, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:45,417][__main__][INFO] - Epoch 7/100: Train Loss: 0.4662, Val Loss: 0.4662
[2025-09-29 10:30:45,417][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38154813647279395), 'mae': 0.2912551164627075, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:45,417][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38152817911541176), 'mae': 0.2940918505191803, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:49,669][__main__][INFO] - Epoch 8/100: Train Loss: 0.4662, Val Loss: 0.4662
[2025-09-29 10:30:49,669][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38155522479370557), 'mae': 0.2914275825023651, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:49,669][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38152845251092143), 'mae': 0.28851670026779175, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:54,086][__main__][INFO] - Epoch 9/100: Train Loss: 0.4661, Val Loss: 0.4662
[2025-09-29 10:30:54,086][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3815146067349086), 'mae': 0.2910501956939697, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:54,086][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38155024540847926), 'mae': 0.2933894097805023, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:58,042][__main__][INFO] - Epoch 10/100: Train Loss: 0.4661, Val Loss: 0.4661
[2025-09-29 10:30:58,042][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38151136491503607), 'mae': 0.29120638966560364, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:30:58,042][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38150011597702843), 'mae': 0.29525360465049744, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:31:02,365][__main__][INFO] - Epoch 11/100: Train Loss: 0.4661, Val Loss: 0.4661
[2025-09-29 10:31:02,365][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38149208918827593), 'mae': 0.2913471460342407, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:31:02,365][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38149667873536725), 'mae': 0.28995516896247864, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:31:06,376][__main__][INFO] - Epoch 12/100: Train Loss: 0.4661, Val Loss: 0.4664
[2025-09-29 10:31:06,376][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.38153768925837866), 'mae': 0.29114243388175964, 'accuracy': np.float64(0.8224979060094831), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:31:06,376][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.38160181306957086), 'mae': 0.2959134876728058, 'accuracy': np.float64(0.8225191663190599), 'precision': 0.0, 'recall': np.float64(0.0), 'f1': 0.0}
[2025-09-29 10:31:06,628][__main__][INFO] - Early stopping after 12 epochs
[2025-09-29 10:31:06,628][__main__][INFO] - Training completed!
[2025-09-29 10:31:06,628][__main__][INFO] - Best validation loss: 0.4660
[2025-09-29 10:31:09,701][__main__][INFO] - MLflow run completed
