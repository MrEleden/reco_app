[2025-09-29 11:17:39,061][__main__][INFO] - Configuration:
[2025-09-29 11:17:39,063][__main__][INFO] - model:
  name: deep_cf
  type: DeepCollaborativeFiltering
  embedding_dim: 64
  hidden_dims:
  - 256
  - 128
  - 64
  dropout: 0.1
  batch_norm: true
  activation: relu
  description: Deep neural network for collaborative filtering
train:
  name: production
  batch_size: 512
  learning_rate: 0.0001
  weight_decay: 5.0e-05
  epochs: 100
  patience: 10
  min_delta: 1.0e-05
  optimizer:
    type: adam
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    amsgrad: true
  scheduler:
    type: cosine
    T_max: 100
    eta_min: 1.0e-06
  loss:
    type: bce
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@5
  - precision@10
  - precision@20
  - recall@5
  - recall@10
  - recall@20
  - ndcg@10
  - f1
  top_k:
  - 5
  - 10
  - 20
  - 50
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto
mlflow:
  tracking_uri: null
  experiment_name: ${experiment.name}
  enable: true
  log_models: true
  log_artifacts: true

[2025-09-29 11:17:39,440][__main__][INFO] - MLflow run started: 74cdd459cf9c4aea9805bd0b2f795373
[2025-09-29 11:17:39,456][__main__][INFO] - Using device: cuda
[2025-09-29 11:17:39,484][__main__][INFO] - Loading data...
[2025-09-29 11:17:39,521][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-29 11:17:39,522][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-29 11:17:40,188][__main__][INFO] - Creating model: DeepCollaborativeFiltering
[2025-09-29 11:17:40,283][__main__][INFO] - Model created with 736,769 parameters
[2025-09-29 11:17:41,224][__main__][INFO] - Starting training...
[2025-09-29 11:17:44,733][__main__][INFO] - Epoch 1/100: Train Loss: 0.4306, Val Loss: 0.3458
[2025-09-29 11:17:44,733][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3711776638523024), 'mae': 0.28415191173553467, 'accuracy': np.float64(0.8344866757496127), 'precision': np.float64(0.6140326882308692), 'recall': np.float64(0.18184579865119388), 'f1': np.float64(0.28059375000000003)}
[2025-09-29 11:17:44,734][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3270015785473744), 'mae': 0.21167509257793427, 'accuracy': np.float64(0.8484098787451635), 'precision': np.float64(0.5922509225092251), 'recall': np.float64(0.4682713347921225), 'f1': np.float64(0.5230142566191446)}
[2025-09-29 11:17:44,966][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 11:17:48,382][__main__][INFO] - Epoch 2/100: Train Loss: 0.3234, Val Loss: 0.3439
[2025-09-29 11:17:48,382][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.31816912155859534), 'mae': 0.20266200602054596, 'accuracy': np.float64(0.8564007807978373), 'precision': np.float64(0.6282745300726313), 'recall': np.float64(0.46774814184741886), 'f1': np.float64(0.5362557756158722)}
[2025-09-29 11:17:48,382][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3250038797807196), 'mae': 0.20397527515888214, 'accuracy': np.float64(0.8503516821771212), 'precision': np.float64(0.6110154905335629), 'recall': np.float64(0.43155847313396545), 'f1': np.float64(0.5058421202621829)}
[2025-09-29 11:17:48,628][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-29 11:17:52,962][__main__][INFO] - Epoch 3/100: Train Loss: 0.3144, Val Loss: 0.3447
[2025-09-29 11:17:52,962][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3152731279568505), 'mae': 0.19875659048557281, 'accuracy': np.float64(0.8582880683881126), 'precision': np.float64(0.6447513812154696), 'recall': np.float64(0.4490552281426575), 'f1': np.float64(0.5293970179187508)}
[2025-09-29 11:17:52,962][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32441923538116724), 'mae': 0.20587125420570374, 'accuracy': np.float64(0.8520201947556924), 'precision': np.float64(0.6200960299800914), 'recall': np.float64(0.42912715779236565), 'f1': np.float64(0.5072324935338633)}
[2025-09-29 11:17:57,451][__main__][INFO] - Epoch 4/100: Train Loss: 0.3099, Val Loss: 0.3464
[2025-09-29 11:17:57,451][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3136645433797093), 'mae': 0.19687367975711823, 'accuracy': np.float64(0.8597943036268275), 'precision': np.float64(0.6594730855544284), 'recall': np.float64(0.4344532879680823), 'f1': np.float64(0.5238199887676117)}
[2025-09-29 11:17:57,451][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32388660928935636), 'mae': 0.20495916903018951, 'accuracy': np.float64(0.8530414395236109), 'precision': np.float64(0.62664120315111), 'recall': np.float64(0.42548018477996596), 'f1': np.float64(0.5068301394989622)}
[2025-09-29 11:18:02,199][__main__][INFO] - Epoch 5/100: Train Loss: 0.3069, Val Loss: 0.3478
[2025-09-29 11:18:02,199][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.31255953936823244), 'mae': 0.19566074013710022, 'accuracy': np.float64(0.8611531506918257), 'precision': np.float64(0.6696538449402039), 'recall': np.float64(0.4297952488000486), 'f1': np.float64(0.5235604677554646)}
[2025-09-29 11:18:02,199][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32345575152145667), 'mae': 0.20409494638442993, 'accuracy': np.float64(0.8536167886886354), 'precision': np.float64(0.6366624525916561), 'recall': np.float64(0.40813680200988733), 'f1': np.float64(0.49740727937182083)}
[2025-09-29 11:18:06,690][__main__][INFO] - Epoch 6/100: Train Loss: 0.3051, Val Loss: 0.3497
[2025-09-29 11:18:06,690][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3119187910644754), 'mae': 0.19476957619190216, 'accuracy': np.float64(0.8614515218727644), 'precision': np.float64(0.675294422156076), 'recall': np.float64(0.42270692832695383), 'f1': np.float64(0.5199476863673164)}
[2025-09-29 11:18:06,690][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3236058313130507), 'mae': 0.2047577053308487, 'accuracy': np.float64(0.8540770680206551), 'precision': np.float64(0.6382656919586589), 'recall': np.float64(0.41040602966204714), 'f1': np.float64(0.49958072312928525)}
[2025-09-29 11:18:11,209][__main__][INFO] - Epoch 7/100: Train Loss: 0.3039, Val Loss: 0.3523
[2025-09-29 11:18:11,209][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.31147744248796033), 'mae': 0.194398432970047, 'accuracy': np.float64(0.8622711439119697), 'precision': np.float64(0.6778206364513019), 'recall': np.float64(0.4270611823318549), 'f1': np.float64(0.5239852398523985)}
[2025-09-29 11:18:11,209][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.32345225028713104), 'mae': 0.20145589113235474, 'accuracy': np.float64(0.8539763819167757), 'precision': np.float64(0.637460716530484), 'recall': np.float64(0.4109733365750871), 'f1': np.float64(0.4997536217601261)}
[2025-09-29 11:18:15,747][__main__][INFO] - Epoch 8/100: Train Loss: 0.3022, Val Loss: 0.3512
[2025-09-29 11:18:15,747][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3108979046593318), 'mae': 0.193598672747612, 'accuracy': np.float64(0.8627348774341517), 'precision': np.float64(0.6806546370121695), 'recall': np.float64(0.4270409299876461), 'f1': np.float64(0.5248145751406242)}
[2025-09-29 11:18:15,747][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3236337807916534), 'mae': 0.20438440144062042, 'accuracy': np.float64(0.853257195460495), 'precision': np.float64(0.6317996792895029), 'recall': np.float64(0.4151065726558068), 'f1': np.float64(0.5010270957644528)}
[2025-09-29 11:18:20,316][__main__][INFO] - Epoch 9/100: Train Loss: 0.3000, Val Loss: 0.3538
[2025-09-29 11:18:20,317][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3100517692715984), 'mae': 0.19280748069286346, 'accuracy': np.float64(0.8633388094630398), 'precision': np.float64(0.6823536965105454), 'recall': np.float64(0.43048382850314926), 'f1': np.float64(0.5279157560103319)}
[2025-09-29 11:18:20,317][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3233458822291957), 'mae': 0.20290662348270416, 'accuracy': np.float64(0.854451044977921), 'precision': np.float64(0.6401161322898258), 'recall': np.float64(0.4109733365750871), 'f1': np.float64(0.5005675929124921)}
[2025-09-29 11:18:24,899][__main__][INFO] - Epoch 10/100: Train Loss: 0.2967, Val Loss: 0.3586
[2025-09-29 11:18:24,899][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3087328343889931), 'mae': 0.19143693149089813, 'accuracy': np.float64(0.8634646286357247), 'precision': np.float64(0.6799861014593468), 'recall': np.float64(0.43597221378374545), 'f1': np.float64(0.5313012895662368)}
[2025-09-29 11:18:24,899][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3236511041125896), 'mae': 0.20102864503860474, 'accuracy': np.float64(0.8535304863138817), 'precision': np.float64(0.6346153846153846), 'recall': np.float64(0.41186481886700704), 'f1': np.float64(0.4995331007028062)}
[2025-09-29 11:18:29,373][__main__][INFO] - Epoch 11/100: Train Loss: 0.2925, Val Loss: 0.3655
[2025-09-29 11:18:29,373][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.30708298089633906), 'mae': 0.18948307633399963, 'accuracy': np.float64(0.8644280440151414), 'precision': np.float64(0.6805125665469852), 'recall': np.float64(0.44526803977560403), 'f1': np.float64(0.5383118075534064)}
[2025-09-29 11:18:29,373][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3245062070798075), 'mae': 0.2022561877965927, 'accuracy': np.float64(0.8535017188556305), 'precision': np.float64(0.6317270058708415), 'recall': np.float64(0.4185914579787665), 'f1': np.float64(0.5035339995125518)}
[2025-09-29 11:18:33,806][__main__][INFO] - Epoch 12/100: Train Loss: 0.2876, Val Loss: 0.3763
[2025-09-29 11:18:33,806][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.30506798633330506), 'mae': 0.18718813359737396, 'accuracy': np.float64(0.8649528897069132), 'precision': np.float64(0.6797345833079685), 'recall': np.float64(0.45227535087186344), 'f1': np.float64(0.5431528255767291)}
[2025-09-29 11:18:33,806][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3259167730081226), 'mae': 0.20200756192207336, 'accuracy': np.float64(0.8524229391712095), 'precision': np.float64(0.6208580397628183), 'recall': np.float64(0.4327741308047654), 'f1': np.float64(0.5100286532951289)}
[2025-09-29 11:18:34,057][__main__][INFO] - Early stopping after 12 epochs
[2025-09-29 11:18:34,057][__main__][INFO] - Training completed!
[2025-09-29 11:18:34,057][__main__][INFO] - Best validation loss: 0.3439
[2025-09-29 11:18:38,250][__main__][INFO] - MLflow run completed
