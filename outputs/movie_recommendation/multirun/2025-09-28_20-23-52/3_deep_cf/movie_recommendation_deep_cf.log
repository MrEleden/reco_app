[2025-09-28 20:25:35,225][__main__][INFO] - Configuration:
[2025-09-28 20:25:35,227][__main__][INFO] - model:
  name: deep_cf
  type: DeepCollaborativeFiltering
  embedding_dim: 64
  hidden_dims:
  - 256
  - 128
  - 64
  dropout: 0.4
  batch_norm: true
  activation: relu
  description: Deep neural network for collaborative filtering
train:
  name: default
  batch_size: 256
  learning_rate: 0.01
  weight_decay: 0.0001
  epochs: 5
  patience: 5
  min_delta: 0.0001
  scheduler:
    type: reduce_on_plateau
    factor: 0.5
    patience: 3
    min_lr: 1.0e-06
    verbose: true
  loss:
    type: bce
    margin: 1.0
    reduction: mean
  validation:
    val_ratio: 0.2
    val_batch_size: 512
    val_frequency: 1
    early_stopping: true
  metrics:
  - rmse
  - mae
  - precision@10
  - recall@10
  - ndcg@10
  top_k:
  - 5
  - 10
  - 20
data:
  name: default
  data_dir: data
  raw_data_dir: data/raw
  min_ratings_per_user: 5
  min_ratings_per_movie: 5
  rating_threshold: 3.0
  negative_sampling: true
  negative_sampling_ratio: 4
  validation_ratio: 0.2
  test_ratio: 0.1
  seed: 42
optimizer:
  type: adam
  betas:
  - 0.9
  - 0.999
  eps: 1.0e-08
  amsgrad: false
experiment:
  name: movie_recommendation
  tags:
  - collaborative_filtering
  - pytorch
  notes: Training movie recommendation models with different configurations
seed: 42
device: auto

[2025-09-28 20:25:35,228][__main__][INFO] - Using device: cuda
[2025-09-28 20:25:35,228][__main__][INFO] - Loading data...
[2025-09-28 20:25:35,291][__main__][INFO] - Loaded 100836 user-movie interactions
[2025-09-28 20:25:35,291][__main__][INFO] - Users: 610, Movies: 9742
[2025-09-28 20:25:36,569][__main__][INFO] - Creating model: DeepCollaborativeFiltering
[2025-09-28 20:25:36,580][__main__][INFO] - Model created with 736,769 parameters
[2025-09-28 20:25:36,582][__main__][INFO] - Starting training...
[2025-09-28 20:25:55,414][__main__][INFO] - Epoch 1/5: Train Loss: 0.3894, Val Loss: 0.3722
[2025-09-28 20:25:55,415][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.34507947369191677), 'mae': 0.23939889669418335, 'accuracy': np.float64(0.8366867138548478), 'precision': np.float64(0.6173375349307331), 'recall': np.float64(0.21028008992040828), 'f1': np.float64(0.31370475557435495)}
[2025-09-28 20:25:55,415][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33840397333211897), 'mae': 0.23468442261219025, 'accuracy': np.float64(0.8442098298404844), 'precision': np.float64(0.6522617124394184), 'recall': np.float64(0.26177161844557906), 'f1': np.float64(0.3736047654849343)}
[2025-09-28 20:25:55,436][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:26:12,476][__main__][INFO] - Epoch 2/5: Train Loss: 0.3675, Val Loss: 0.3592
[2025-09-28 20:26:12,476][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3356412313042144), 'mae': 0.22611182928085327, 'accuracy': np.float64(0.8426900858086758), 'precision': np.float64(0.6311463927153864), 'recall': np.float64(0.2737306843267108), 'f1': np.float64(0.3818510566165668)}
[2025-09-28 20:26:12,476][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33279775891320285), 'mae': 0.2272971272468567, 'accuracy': np.float64(0.8466694475209643), 'precision': np.float64(0.6105041463735685), 'recall': np.float64(0.3758813518113299), 'f1': np.float64(0.4652889245585875)}
[2025-09-28 20:26:12,486][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:26:31,094][__main__][INFO] - Epoch 3/5: Train Loss: 0.3591, Val Loss: 0.3591
[2025-09-28 20:26:31,095][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.3322663316465784), 'mae': 0.22166317701339722, 'accuracy': np.float64(0.8443580885551286), 'precision': np.float64(0.6378099079907538), 'recall': np.float64(0.28499098770682707), 'f1': np.float64(0.39395296752519593)}
[2025-09-28 20:26:31,095][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3325369518046798), 'mae': 0.21797434985637665, 'accuracy': np.float64(0.847014657019979), 'precision': np.float64(0.620591984138224), 'recall': np.float64(0.3551341275630116), 'f1': np.float64(0.4517525773195876)}
[2025-09-28 20:26:31,111][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:26:45,847][__main__][INFO] - Epoch 4/5: Train Loss: 0.3557, Val Loss: 0.3533
[2025-09-28 20:26:45,848][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33100400103429883), 'mae': 0.21985003352165222, 'accuracy': np.float64(0.8449080980814374), 'precision': np.float64(0.6367225195192561), 'recall': np.float64(0.29398302853555297), 'f1': np.float64(0.40224454450987185)}
[2025-09-28 20:26:45,848][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.33118504796125564), 'mae': 0.2242198884487152, 'accuracy': np.float64(0.8463817729384521), 'precision': np.float64(0.6798959011060507), 'recall': np.float64(0.2540724531971797), 'f1': np.float64(0.36991150442477877)}
[2025-09-28 20:26:45,865][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:26:59,818][__main__][INFO] - Epoch 5/5: Train Loss: 0.3547, Val Loss: 0.3499
[2025-09-28 20:26:59,819][__main__][INFO] - Train Metrics: {'rmse': np.float64(0.33077813584452437), 'mae': 0.2194451242685318, 'accuracy': np.float64(0.8449907792520589), 'precision': np.float64(0.635826857118048), 'recall': np.float64(0.29659558093849364), 'f1': np.float64(0.40450214058831657)}
[2025-09-28 20:26:59,819][__main__][INFO] - Val Metrics: {'rmse': np.float64(0.3296368600724631), 'mae': 0.2198001593351364, 'accuracy': np.float64(0.8474893200811242), 'precision': np.float64(0.6767820773930754), 'recall': np.float64(0.26930869600453844), 'f1': np.float64(0.38529769841729955)}
[2025-09-28 20:26:59,835][__main__][INFO] - New best model saved: best_model_deep_cf.pth
[2025-09-28 20:26:59,836][__main__][INFO] - Training completed!
[2025-09-28 20:26:59,836][__main__][INFO] - Best validation loss: 0.3499
